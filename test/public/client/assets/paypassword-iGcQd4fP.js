import{d as F,V as I,a9 as U,a as o,a8 as N,W as S,f as d,X as v,_ as s,Y as f,a0 as A,a2 as J,a6 as T,Z as W,ab as D,a5 as _,a3 as n,a7 as E}from"./index-DS0Nckzj.js";import{_ as L,B as M,x as O}from"./CpNavBar-BjhapZaz.js";import"./index-DYKC6Cu2.js";import{F as X}from"./index-Jqpqfn-5.js";import{F as Y}from"./index-Cq8NhW0v.js";import"./use-id-Db2T4G9A.js";const Z={class:"page"},$={class:"mt-8 px-8"},j={class:"text-base"},z=F({__name:"paypassword",setup(G){const{t:e}=I(),g=N(),h=D(),b=U(),u=o(!1),i=o(!1),c=o(!1),p=o(""),a=o(""),m=o(""),t=o(!1),P=g.query.isJump||0,V=()=>{u.value=!u.value},k=()=>{i.value=!i.value},x=()=>{c.value=!c.value},R=async()=>{if(!t.value){if(a.value!==m.value){n(e("payPassword.rules.passwordMismatch"));return}if(a.value.length!==6||!/^\d+$/.test(a.value)){n(e("payPassword.rules.passwordLength"));return}if(P==0&&p.value===a.value){n(e("payPassword.rules.sameAsOld"));return}t.value=!0;try{await O(p.value,a.value,m.value).then(w=>{n(w.msg),b.setUserPayPassword(1),setTimeout(()=>{h.back()},1e3)})}catch(w){n(w.message||"修改失败")}finally{t.value=!1}}};return(w,l)=>{const q=L,y=X,B=M,C=Y;return _(),S(A,null,[d(q,{title:s(e)("payPassword.title")},null,8,["title"]),v("div",Z,[d(C,{onSubmit:R},{default:f(()=>[s(P)==0?(_(),J(y,{key:0,"left-icon":"lock",modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=r=>p.value=r),type:u.value?"text":"password","right-icon":u.value?"eye-o":"closed-eye",onClickRightIcon:V,label:s(e)("payPassword.oldPassword"),placeholder:s(e)("payPassword.oldPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.oldPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"])):T("",!0),d(y,{"left-icon":"lock",modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=r=>a.value=r),type:i.value?"text":"password","right-icon":i.value?"eye-o":"closed-eye",onClickRightIcon:k,label:s(e)("payPassword.newPassword"),placeholder:s(e)("payPassword.newPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.newPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"]),d(y,{"left-icon":"lock",modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=r=>m.value=r),type:c.value?"text":"password","right-icon":c.value?"eye-o":"closed-eye",onClickRightIcon:x,label:s(e)("payPassword.confirmPassword"),placeholder:s(e)("payPassword.confirmPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.confirmPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"]),v("div",$,[d(B,{round:"",block:"",type:"primary","native-type":"submit",loading:t.value,disabled:t.value},{default:f(()=>[v("span",j,W(s(e)("payPassword.submit")),1)]),_:1},8,["loading","disabled"])])]),_:1})])],64)}}}),oe=E(z,[["__scopeId","data-v-0850193d"]]);export{oe as default};
