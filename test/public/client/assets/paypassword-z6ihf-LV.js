import{_ as B,F as I,K as d,ak as U}from"./CpNavBar-BGhrA26v.js";import"./index-BQYZZJmj.js";import{F as N}from"./index-9FrfasKp.js";import{d as S,u as A,y as J,a as o,s as T,g as j,b as u,h as v,j as s,i as _,F as z,p as D,x as E,t as K,z as L,q as f,_ as M}from"./index-DqBSD0aN.js";import{F as O}from"./index-Drp5RFFs.js";import"./use-id-BHI6m-7i.js";const W={class:"page"},$={class:"mt-8 px-8"},G={class:"text-base"},H=S({__name:"paypassword",setup(Q){const{t:e}=A(),g=T(),h=L(),b=J(),n=o(!1),i=o(!1),c=o(!1),p=o(""),a=o(""),m=o(""),t=o(!1),P=g.query.isJump||0,V=()=>{n.value=!n.value},k=()=>{i.value=!i.value},x=()=>{c.value=!c.value},q=async()=>{if(!t.value){if(a.value!==m.value){d(e("payPassword.rules.passwordMismatch"));return}if(a.value.length!==6||!/^\d+$/.test(a.value)){d(e("payPassword.rules.passwordLength"));return}if(P==0&&p.value===a.value){d(e("payPassword.rules.sameAsOld"));return}t.value=!0;try{await U(p.value,a.value,m.value).then(w=>{d(w.msg),b.setUserPayPassword(1),setTimeout(()=>{h.back()},1e3)})}catch(w){d(w.message||"修改失败")}finally{t.value=!1}}};return(w,l)=>{const R=B,y=N,C=I,F=O;return f(),j(z,null,[u(R,{title:s(e)("payPassword.title")},null,8,["title"]),v("div",W,[u(F,{onSubmit:q},{default:_(()=>[s(P)==0?(f(),D(y,{key:0,"left-icon":"lock",modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=r=>p.value=r),type:n.value?"text":"password","right-icon":n.value?"eye-o":"closed-eye",onClickRightIcon:V,label:s(e)("payPassword.oldPassword"),placeholder:s(e)("payPassword.oldPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.oldPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"])):E("",!0),u(y,{"left-icon":"lock",modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=r=>a.value=r),type:i.value?"text":"password","right-icon":i.value?"eye-o":"closed-eye",onClickRightIcon:k,label:s(e)("payPassword.newPassword"),placeholder:s(e)("payPassword.newPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.newPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"]),u(y,{"left-icon":"lock",modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=r=>m.value=r),type:c.value?"text":"password","right-icon":c.value?"eye-o":"closed-eye",onClickRightIcon:x,label:s(e)("payPassword.confirmPassword"),placeholder:s(e)("payPassword.confirmPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.confirmPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"]),v("div",$,[u(C,{round:"",block:"",type:"primary","native-type":"submit",loading:t.value,disabled:t.value},{default:_(()=>[v("span",G,K(s(e)("payPassword.submit")),1)]),_:1},8,["loading","disabled"])])]),_:1})])],64)}}}),oe=M(H,[["__scopeId","data-v-0850193d"]]);export{oe as default};
