import{d as F,V as I,ah as U,a as o,ag as N,W as S,f as d,Y as v,a1 as s,$ as f,Z as A,a3 as J,ad as O,a0 as T,a9 as W,aa as g,a6 as n,aO as $,af as D}from"./index-CW24Rrz8.js";import{_ as E,B as L}from"./CpNavBar-CJHi_sXB.js";import"./index-B90dZW2P.js";import{F as M}from"./index-CKNkarPs.js";import{F as Y}from"./index-B51PszVi.js";import"./use-id-DPpD5rJm.js";const Z={class:"page"},j={class:"mt-8 px-8"},z={class:"text-base"},G=F({__name:"paypassword",setup(H){const{t:e}=I(),_=N(),h=W(),b=U(),u=o(!1),i=o(!1),c=o(!1),p=o(""),a=o(""),m=o(""),t=o(!1),P=_.query.isJump||0,V=()=>{u.value=!u.value},k=()=>{i.value=!i.value},x=()=>{c.value=!c.value},R=async()=>{if(!t.value){if(a.value!==m.value){n(e("payPassword.rules.passwordMismatch"));return}if(a.value.length!==6||!/^\d+$/.test(a.value)){n(e("payPassword.rules.passwordLength"));return}if(P==0&&p.value===a.value){n(e("payPassword.rules.sameAsOld"));return}t.value=!0;try{await $(p.value,a.value,m.value).then(w=>{n(w.msg),b.setUserPayPassword(1),setTimeout(()=>{h.back()},1e3)})}catch(w){n(w.message||"修改失败")}finally{t.value=!1}}};return(w,l)=>{const q=E,y=M,B=L,C=Y;return g(),S(A,null,[d(q,{title:s(e)("payPassword.title")},null,8,["title"]),v("div",Z,[d(C,{onSubmit:R},{default:f(()=>[s(P)==0?(g(),J(y,{key:0,"left-icon":"lock",modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=r=>p.value=r),type:u.value?"text":"password","right-icon":u.value?"eye-o":"closed-eye",onClickRightIcon:V,label:s(e)("payPassword.oldPassword"),placeholder:s(e)("payPassword.oldPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.oldPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"])):O("",!0),d(y,{"left-icon":"lock",modelValue:a.value,"onUpdate:modelValue":l[1]||(l[1]=r=>a.value=r),type:i.value?"text":"password","right-icon":i.value?"eye-o":"closed-eye",onClickRightIcon:k,label:s(e)("payPassword.newPassword"),placeholder:s(e)("payPassword.newPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.newPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"]),d(y,{"left-icon":"lock",modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=r=>m.value=r),type:c.value?"text":"password","right-icon":c.value?"eye-o":"closed-eye",onClickRightIcon:x,label:s(e)("payPassword.confirmPassword"),placeholder:s(e)("payPassword.confirmPasswordPlaceholder"),rules:[{required:!0,message:s(e)("payPassword.rules.confirmPasswordRequired")}]},null,8,["modelValue","type","right-icon","label","placeholder","rules"]),v("div",j,[d(B,{round:"",block:"",type:"primary","native-type":"submit",loading:t.value,disabled:t.value},{default:f(()=>[v("span",z,T(s(e)("payPassword.submit")),1)]),_:1},8,["loading","disabled"])])]),_:1})])],64)}}}),oe=D(G,[["__scopeId","data-v-0850193d"]]);export{oe as default};
