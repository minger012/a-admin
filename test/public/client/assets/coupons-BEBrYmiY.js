import{_ as R,a3 as f}from"./CpNavBar-BGhrA26v.js";import{P as D,L as U}from"./index-BOOpFCIE.js";import{a as k}from"./common-VvLUS-WY.js";import{d as z,u as E,a as c,w as F,g,b as u,h as t,i as h,j as a,F as b,l as I,B as M,t as d,q as x,_ as P}from"./index-DqBSD0aN.js";import{T as S,a as j}from"./index-D2Ubb90o.js";import"./use-tab-status-DAeoIkwI.js";import"./use-id-BHI6m-7i.js";import"./index-BalXGief.js";const q={class:"tab-wrap"},G={class:"coupon-list"},H={role:"feed",class:"van-list","aria-busy":"false"},J={class:"item-left"},K={class:"coupon-type"},O={class:"item-content"},Q={class:"title-line"},W={class:"title"},X={class:"text"},Y={class:"name"},Z={class:"time"},$=z({__name:"coupons",setup(ee){const{t:e}=E(),w=k(),n=c({page:0,pageSize:10}),p=c(0),r=c(!1),v=c(!1),m=c([]),y=async()=>{v.value||(r.value=!0,n.value.page++,await f(n.value,p.value).then(i=>{m.value.push(...i.data.list),n.value.page>=i.data.total_page&&(v.value=!0),r.value=!1}).catch(()=>{r.value=!1}))},l=c(!1),C=async()=>{n.value.page=1,await f(n.value,p.value).then(i=>{m.value=i.data.list,l.value=!1}).catch(()=>{l.value=!1})};F(p,async i=>{n.value.page=1,m.value=[],l.value=!0,await f(n.value,i).then(s=>{m.value=s.data.list,l.value=!1}).catch(()=>{l.value=!1})});let L={1:e("coupons.valueAdded"),2:e("coupons.deduction"),3:e("coupons.team"),4:e("coupons.custom"),5:e("coupons.fixedAmount")},T={1:e("coupons.unused"),2:e("coupons.used"),3:e("coupons.isExpired")};return(i,s)=>{const B=R,_=j,N=S,V=U,A=D;return x(),g(b,null,[u(B),t("div",q,[u(N,{active:p.value,"onUpdate:active":s[0]||(s[0]=o=>p.value=o),"line-width":"5.625rem"},{default:h(()=>[u(_,{title:a(e)("coupons.all")},null,8,["title"]),u(_,{title:a(e)("coupons.unused")},null,8,["title"]),u(_,{title:a(e)("coupons.used")},null,8,["title"])]),_:1},8,["active"])]),u(A,{modelValue:l.value,"onUpdate:modelValue":s[2]||(s[2]=o=>l.value=o),onRefresh:C,"pulling-text":a(e)("common.pullDownRefresh"),"loosing-text":a(e)("common.releaseRefresh"),"loading-text":a(e)("common.loading")},{default:h(()=>[u(V,{loading:r.value,"onUpdate:loading":s[1]||(s[1]=o=>r.value=o),finished:v.value,"finished-text":a(e)("common.noMore"),"loading-text":a(e)("common.loading"),"error-text":a(e)("common.fail"),onLoad:y},{default:h(()=>[t("div",G,[t("div",H,[(x(!0),g(b,null,I(m.value,o=>(x(),g("div",{class:M(["coupon-item",o.state==1?"":"used"])},[t("div",J,[t("div",K,d(a(L)[o.type]),1),s[3]||(s[3]=t("div",{class:"tag"},null,-1))]),t("div",O,[t("div",Q,[t("div",W,d(o.name),1),t("span",X,d(a(T)[o.state]),1)]),t("div",Y,d(o.intro),1),t("div",Z,d(a(w).formatToMonthDay(o.create_time,1))+" "+d(a(e)("coupons.expired")),1)])],2))),256)),s[4]||(s[4]=t("div",{class:"van-list__placeholder"},null,-1))])])]),_:1},8,["loading","finished","finished-text","loading-text","error-text"])]),_:1},8,["modelValue","pulling-text","loosing-text","loading-text"])],64)}}}),ce=P($,[["__scopeId","data-v-9b2d53be"]]);export{ce as default};
