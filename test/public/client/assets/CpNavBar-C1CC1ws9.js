import{a as _,v as pe,z as ee,b8 as qe,w as Z,j as Ge,x as We,y as Je,f as s,d as $,t as L,g as H,aJ as _e,J as K,bc as Ze,E as P,aH as Qe,l as U,n as F,I as me,p as ve,L as Pe,ak as ge,c as D,e as he,N as Xe,h as se,m as G,s as te,u as et,bb as tt,b as Ie,H as ne,o as Q,b5 as nt,B as ce,A as be,bl as ot,bm as ae,r as at,bn as lt,bo as it,aj as st,P as De,bp as ct,q as rt,bq as Be,M as ut,aI as dt,br as ft,C as mt,D as vt,F as gt,G as ht,aG as bt,bs as Bt,W as re,be as $e,a4 as Ee,Y as Ne,ab as M,ae as Re,V as yt,ag as Ct,af as kt,bt as wt,a3 as W,$ as le,a1 as ye,bu as xt,aa as Tt,bv as Ce,ac as q,a0 as St,bw as Ot,bx as pt,by as _t}from"./index-CXea43oC.js";const Pt=(e,n)=>{const t=_(),a=()=>{t.value=Ge(e).height};return pe(()=>{ee(a);for(let l=1;l<=3;l++)setTimeout(a,100*l)}),qe(()=>ee(a)),Z([We,Je],a),t};function He(e,n){const t=Pt(e);return a=>s("div",{class:n("placeholder"),style:{height:t.value?`${t.value}px`:void 0}},[a()])}const[Ae,ke]=H("action-bar"),Le=Symbol(Ae),It={placeholder:Boolean,safeAreaInsetBottom:L};var Dt=$({name:Ae,props:It,setup(e,{slots:n}){const t=_(),a=He(t,ke),{linkChildren:l}=_e(Le);l();const b=()=>{var v;return s("div",{ref:t,class:[ke(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(v=n.default)==null?void 0:v.call(n)])};return()=>e.placeholder?a(b):b()}});const $t=K(Dt),Me={to:[String,Object],url:String,replace:Boolean};function Et({to:e,url:n,replace:t,$router:a}){e&&a?a[t?"replace":"push"](e):n&&(t?location.replace(n):location.href=n)}function Ue(){const e=Ze().proxy;return()=>Et(e)}const[Nt,V]=H("button"),Rt=P({},Me,{tag:U("button"),text:String,icon:String,type:U("default"),size:U("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:U("button"),loadingSize:F,loadingText:String,loadingType:String,iconPosition:U("left")});var Ht=$({name:Nt,props:Rt,emits:["click"],setup(e,{emit:n,slots:t}){const a=Ue(),l=()=>t.loading?t.loading():s(Pe,{size:e.loadingSize,type:e.loadingType,class:V("loading")},null),b=()=>{if(e.loading)return l();if(t.icon)return s("div",{class:V("icon")},[t.icon()]);if(e.icon)return s(me,{name:e.icon,class:V("icon"),classPrefix:e.iconPrefix},null)},v=()=>{let r;if(e.loading?r=e.loadingText:r=t.default?t.default():e.text,r)return s("span",{class:V("text")},[r])},g=()=>{const{color:r,plain:f}=e;if(r){const h={color:f?r:"white"};return f||(h.background=r),r.includes("gradient")?h.border=0:h.borderColor=r,h}},d=r=>{e.loading?ve(r):e.disabled||(n("click",r),a())};return()=>{const{tag:r,type:f,size:h,block:w,round:C,plain:p,square:T,loading:k,disabled:i,hairline:u,nativeType:y,iconPosition:x}=e,S=[V([f,h,{plain:p,block:w,round:C,square:T,loading:k,disabled:i,hairline:u}]),{[Qe]:u}];return s(r,{type:y,class:S,style:g(),disabled:i,onClick:d},{default:()=>[s("div",{class:V("content")},[x==="left"&&b(),v(),x==="right"&&b()])]})}}});const ue=K(Ht),[At,Lt]=H("action-bar-button"),Mt=P({},Me,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var Ut=$({name:At,props:Mt,setup(e,{slots:n}){const t=Ue(),{parent:a,index:l}=ge(Le),b=D(()=>{if(a){const g=a.children[l.value-1];return!(g&&"isButton"in g)}}),v=D(()=>{if(a){const g=a.children[l.value+1];return!(g&&"isButton"in g)}});return he({isButton:!0}),()=>{const{type:g,icon:d,text:r,color:f,loading:h,disabled:w}=e;return s(ue,{class:Lt([g,{last:v.value,first:b.value}]),size:"large",type:g,icon:d,color:f,loading:h,disabled:w,onClick:t},{default:()=>[n.default?n.default():r]})}}});const we=K(Ut),[zt,R,xe]=H("picker"),ze=e=>e.find(n=>!n.disabled)||e[0];function Vt(e,n){const t=e[0];if(t){if(Array.isArray(t))return"multiple";if(n.children in t)return"cascade"}return"default"}function X(e,n){n=se(n,0,e.length);for(let t=n;t<e.length;t++)if(!e[t].disabled)return t;for(let t=n-1;t>=0;t--)if(!e[t].disabled)return t;return 0}const Te=(e,n,t)=>n!==void 0&&!!e.find(a=>a[t.value]===n);function de(e,n,t){const a=e.findIndex(b=>b[t.value]===n),l=X(e,a);return e[l]}function Ft(e,n,t){const a=[];let l={[n.children]:e},b=0;for(;l&&l[n.children];){const v=l[n.children],g=t.value[b];if(l=Xe(g)?de(v,g,n):void 0,!l&&v.length){const d=ze(v)[n.value];l=de(v,d,n)}b++,a.push(v)}return a}function Kt(e){const{transform:n}=window.getComputedStyle(e),t=n.slice(7,n.length-1).split(", ")[5];return Number(t)}function Yt(e){return P({text:"text",value:"value",children:"children"},e)}const Se=200,Oe=300,jt=15,[Ve,ie]=H("picker-column"),Fe=Symbol(Ve);var qt=$({name:Ve,props:{value:F,fields:G(Object),options:te(),readonly:Boolean,allowHtml:Boolean,optionHeight:G(Number),swipeDuration:G(F),visibleOptionNum:G(F)},emits:["change","clickOption","scrollInto"],setup(e,{emit:n,slots:t}){let a,l,b,v,g;const d=_(),r=_(),f=_(0),h=_(0),w=et(),C=()=>e.options.length,p=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,T=B=>{let o=X(e.options,B);const c=-o*e.optionHeight,m=()=>{o>C()-1&&(o=X(e.options,B));const A=e.options[o][e.fields.value];A!==e.value&&n("change",A)};a&&c!==f.value?g=m:m(),f.value=c},k=()=>e.readonly||!e.options.length,i=B=>{a||k()||(g=null,h.value=Se,T(B),n("clickOption",e.options[B]))},u=B=>se(Math.round(-B/e.optionHeight),0,C()-1),y=D(()=>u(f.value)),x=(B,o)=>{const c=Math.abs(B/o);B=f.value+c/.003*(B<0?-1:1);const m=u(B);h.value=+e.swipeDuration,T(m)},S=()=>{a=!1,h.value=0,g&&(g(),g=null)},E=B=>{if(!k()){if(w.start(B),a){const o=Kt(r.value);f.value=Math.min(0,o-p())}h.value=0,l=f.value,b=Date.now(),v=l,g=null}},Y=B=>{if(k())return;w.move(B),w.isVertical()&&(a=!0,ve(B,!0));const o=se(l+w.deltaY.value,-(C()*e.optionHeight),e.optionHeight),c=u(o);c!==y.value&&n("scrollInto",e.options[c]),f.value=o;const m=Date.now();m-b>Oe&&(b=m,v=o)},O=()=>{if(k())return;const B=f.value-v,o=Date.now()-b;if(o<Oe&&Math.abs(B)>jt){x(B,o);return}const m=u(f.value);h.value=Se,T(m),setTimeout(()=>{a=!1},0)},z=()=>{const B={height:`${e.optionHeight}px`};return e.options.map((o,c)=>{const m=o[e.fields.text],{disabled:A}=o,j=o[e.fields.value],Ye={role:"button",style:B,tabindex:A?-1:0,class:[ie("item",{disabled:A,selected:j===e.value}),o.className],onClick:()=>i(c)},je={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:m};return s("li",Ye,[t.option?t.option(o,c):s("div",je,null)])})};return ge(Fe),he({stopMomentum:S}),tt(()=>{const B=a?Math.floor(-f.value/e.optionHeight):e.options.findIndex(m=>m[e.fields.value]===e.value),o=X(e.options,B),c=-o*e.optionHeight;a&&o<B&&S(),f.value=c}),Ie("touchmove",Y,{target:d}),()=>s("div",{ref:d,class:ie(),onTouchstartPassive:E,onTouchend:O,onTouchcancel:O},[s("ul",{ref:r,style:{transform:`translate3d(0, ${f.value+p()}px, 0)`,transitionDuration:`${h.value}ms`,transitionProperty:h.value?"all":"none"},class:ie("wrapper"),onTransitionend:S},[z()])])}});const[Gt]=H("picker-toolbar"),oe={title:String,cancelButtonText:String,confirmButtonText:String},Wt=["cancel","confirm","title","toolbar"],Jt=Object.keys(oe);var Zt=$({name:Gt,props:oe,emits:["confirm","cancel"],setup(e,{emit:n,slots:t}){const a=()=>{if(t.title)return t.title();if(e.title)return s("div",{class:[R("title"),"van-ellipsis"]},[e.title])},l=()=>n("cancel"),b=()=>n("confirm"),v=()=>{var d;const r=(d=e.cancelButtonText)!=null?d:xe("cancel");if(!(!t.cancel&&!r))return s("button",{type:"button",class:[R("cancel"),ne],onClick:l},[t.cancel?t.cancel():r])},g=()=>{var d;const r=(d=e.confirmButtonText)!=null?d:xe("confirm");if(!(!t.confirm&&!r))return s("button",{type:"button",class:[R("confirm"),ne],onClick:b},[t.confirm?t.confirm():r])};return()=>s("div",{class:R("toolbar")},[t.toolbar?t.toolbar():[v(),a(),g()]])}});const[Qt,xn]=H("picker-group"),Xt=Symbol(Qt);P({tabs:te(),activeTab:Q(0),nextStepText:String,showToolbar:L},oe);const en=P({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:Q(44),showToolbar:L,swipeDuration:Q(1e3),visibleOptionNum:Q(6)},oe),tn=P({},en,{columns:te(),modelValue:te(),toolbarPosition:U("top"),columnsFieldNames:Object});var nn=$({name:zt,props:tn,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:n,slots:t}){const a=_(),l=_(e.modelValue.slice(0)),{parent:b}=ge(Xt),{children:v,linkChildren:g}=_e(Fe);g();const d=D(()=>Yt(e.columnsFieldNames)),r=D(()=>nt(e.optionHeight)),f=D(()=>Vt(e.columns,d.value)),h=D(()=>{const{columns:o}=e;switch(f.value){case"multiple":return o;case"cascade":return Ft(o,d.value,l);default:return[o]}}),w=D(()=>h.value.some(o=>o.length)),C=D(()=>h.value.map((o,c)=>de(o,l.value[c],d.value))),p=D(()=>h.value.map((o,c)=>o.findIndex(m=>m[d.value.value]===l.value[c]))),T=(o,c)=>{if(l.value[o]!==c){const m=l.value.slice(0);m[o]=c,l.value=m}},k=()=>({selectedValues:l.value.slice(0),selectedOptions:C.value,selectedIndexes:p.value}),i=(o,c)=>{T(c,o),f.value==="cascade"&&l.value.forEach((m,A)=>{const j=h.value[A];Te(j,m,d.value)||T(A,j.length?j[0][d.value.value]:void 0)}),ee(()=>{n("change",P({columnIndex:c},k()))})},u=(o,c)=>{const m={columnIndex:c,currentOption:o};n("clickOption",P(k(),m)),n("scrollInto",m)},y=()=>{v.forEach(c=>c.stopMomentum());const o=k();return ee(()=>{n("confirm",o)}),o},x=()=>n("cancel",k()),S=()=>h.value.map((o,c)=>s(qt,{value:l.value[c],fields:d.value,options:o,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:r.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:m=>i(m,c),onClickOption:m=>u(m,c),onScrollInto:m=>{n("scrollInto",{currentOption:m,columnIndex:c})}},{option:t.option})),E=o=>{if(w.value){const c={height:`${r.value}px`},m={backgroundSize:`100% ${(o-r.value)/2}px`};return[s("div",{class:R("mask"),style:m},null),s("div",{class:[ot,R("frame")],style:c},null)]}},Y=()=>{const o=r.value*+e.visibleOptionNum,c={height:`${o}px`};return!e.loading&&!w.value&&t.empty?t.empty():s("div",{ref:a,class:R("columns"),style:c},[S(),E(o)])},O=()=>{if(e.showToolbar&&!b)return s(Zt,be(ce(e,Jt),{onConfirm:y,onCancel:x}),ce(t,Wt))};Z(h,o=>{o.forEach((c,m)=>{c.length&&!Te(c,l.value[m],d.value)&&T(m,ze(c)[d.value.value])})},{immediate:!0});let z;return Z(()=>e.modelValue,o=>{!ae(o,l.value)&&!ae(o,z)&&(l.value=o.slice(0),z=o.slice(0))},{deep:!0}),Z(l,o=>{ae(o,e.modelValue)||(z=o.slice(0),n("update:modelValue",z))},{immediate:!0}),Ie("touchmove",ve,{target:a}),he({confirm:y,getSelectedOptions:()=>C.value}),()=>{var o,c;return s("div",{class:R()},[e.toolbarPosition==="top"?O():null,e.loading?s(Pe,{class:R("loading")},null):null,(o=t["columns-top"])==null?void 0:o.call(t),Y(),(c=t["columns-bottom"])==null?void 0:c.call(t),e.toolbarPosition==="bottom"?O():null])}}});const on=K(nn),[an,I,J]=H("dialog"),ln=P({},ct,{title:String,theme:String,width:F,message:[String,Function],callback:Function,allowHtml:Boolean,className:rt,transition:U("van-dialog-bounce"),messageAlign:String,closeOnPopstate:L,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:L,closeOnClickOverlay:Boolean,keyboardEnabled:L}),sn=[...it,"transition","closeOnPopstate"];var Ke=$({name:an,props:ln,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:n,slots:t}){const a=_(),l=at({confirm:!1,cancel:!1}),b=i=>n("update:show",i),v=i=>{var u;b(!1),(u=e.callback)==null||u.call(e,i)},g=i=>()=>{e.show&&(n(i),e.beforeClose?(l[i]=!0,mt(e.beforeClose,{args:[i],done(){v(i),l[i]=!1},canceled(){l[i]=!1}})):v(i))},d=g("cancel"),r=g("confirm"),f=lt(i=>{var u,y;if(!e.keyboardEnabled||i.target!==((y=(u=a.value)==null?void 0:u.popupRef)==null?void 0:y.value))return;({Enter:e.showConfirmButton?r:Be,Escape:e.showCancelButton?d:Be})[i.key](),n("keydown",i)},["enter","esc"]),h=()=>{const i=t.title?t.title():e.title;if(i)return s("div",{class:I("header",{isolated:!e.message&&!t.default})},[i])},w=i=>{const{message:u,allowHtml:y,messageAlign:x}=e,S=I("message",{"has-title":i,[x]:x}),E=ut(u)?u():u;return y&&typeof E=="string"?s("div",{class:S,innerHTML:E},null):s("div",{class:S},[E])},C=()=>{if(t.default)return s("div",{class:I("content")},[t.default()]);const{title:i,message:u,allowHtml:y}=e;if(u){const x=!!(i||t.title);return s("div",{key:y?1:0,class:I("content",{isolated:!x})},[w(x)])}},p=()=>s("div",{class:[ft,I("footer")]},[e.showCancelButton&&s(ue,{size:"large",text:e.cancelButtonText||J("cancel"),class:I("cancel"),style:{color:e.cancelButtonColor},loading:l.cancel,disabled:e.cancelButtonDisabled,onClick:d},null),e.showConfirmButton&&s(ue,{size:"large",text:e.confirmButtonText||J("confirm"),class:[I("confirm"),{[dt]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:l.confirm,disabled:e.confirmButtonDisabled,onClick:r},null)]),T=()=>s($t,{class:I("footer")},{default:()=>[e.showCancelButton&&s(we,{type:"warning",text:e.cancelButtonText||J("cancel"),class:I("cancel"),color:e.cancelButtonColor,loading:l.cancel,disabled:e.cancelButtonDisabled,onClick:d},null),e.showConfirmButton&&s(we,{type:"danger",text:e.confirmButtonText||J("confirm"),class:I("confirm"),color:e.confirmButtonColor,loading:l.confirm,disabled:e.confirmButtonDisabled,onClick:r},null)]}),k=()=>t.footer?t.footer():e.theme==="round-button"?T():p();return()=>{const{width:i,title:u,theme:y,message:x,className:S}=e;return s(De,be({ref:a,role:"dialog",class:[I([y]),S],style:{width:st(i)},tabindex:0,"aria-labelledby":u||x,onKeydown:f,"onUpdate:show":b},ce(e,sn)),{default:()=>[h(),C(),k()]})}}});let fe;const cn={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let rn=P({},cn);function un(){({instance:fe}=gt({setup(){const{state:n,toggle:t}=ht();return()=>s(Ke,be(n,{"onUpdate:show":t}),null)}}))}function dn(e){return vt?new Promise((n,t)=>{fe||un(),fe.open(P({},rn,e,{callback:a=>{(a==="confirm"?n:t)(a)}}))}):Promise.resolve(void 0)}const fn=e=>dn(P({showCancelButton:!0},e));K(Ke);const[mn,N]=H("nav-bar"),vn={title:String,fixed:Boolean,zIndex:F,border:L,leftText:String,rightText:String,leftDisabled:Boolean,rightDisabled:Boolean,leftArrow:Boolean,placeholder:Boolean,safeAreaInsetTop:Boolean,clickable:L};var gn=$({name:mn,props:vn,emits:["clickLeft","clickRight"],setup(e,{emit:n,slots:t}){const a=_(),l=He(a,N),b=f=>{e.leftDisabled||n("clickLeft",f)},v=f=>{e.rightDisabled||n("clickRight",f)},g=()=>t.left?t.left():[e.leftArrow&&s(me,{class:N("arrow"),name:"arrow-left"},null),e.leftText&&s("span",{class:N("text")},[e.leftText])],d=()=>t.right?t.right():s("span",{class:N("text")},[e.rightText]),r=()=>{const{title:f,fixed:h,border:w,zIndex:C}=e,p=bt(C),T=e.leftArrow||e.leftText||t.left,k=e.rightText||t.right;return s("div",{ref:a,style:p,class:[N({fixed:h}),{[Bt]:w,"van-safe-area-top":e.safeAreaInsetTop}]},[s("div",{class:N("content")},[T&&s("div",{class:[N("left",{disabled:e.leftDisabled}),e.clickable&&!e.leftDisabled?ne:""],onClick:b},[g()]),s("div",{class:[N("title"),"van-ellipsis"]},[t.title?t.title():f]),k&&s("div",{class:[N("right",{disabled:e.rightDisabled}),e.clickable&&!e.rightDisabled?ne:""],onClick:v},[d()])])])};return()=>e.fixed&&e.placeholder?l(r):r()}});const hn=K(gn),bn=["fill"],Bn=$({__name:"CpSvg",props:{name:{},color:{}},setup(e){const n=e,t="#icon-"+n.name;return(a,l)=>(M(),re("svg",{"aria-hidden":"true",class:Ee(["svg-icon icon",a.$attrs.class]),style:$e({color:n.color})},[Ne("use",{href:t,fill:n.color},null,8,bn)],6))}}),yn=Re(Bn,[["__scopeId","data-v-4c3efa61"]]),Cn={class:"header-right"},kn=$({__name:"CpNavBar",props:{title:{},fixed:{type:Boolean,default:()=>!0},isBack:{type:Boolean,default:()=>!0},isLogin:{type:Boolean,default:()=>!1},isLoginOut:{type:Boolean,default:()=>!1},isLang:{type:Boolean,default:()=>!0}},setup(e,{expose:n}){const{t}=yt(),a=Tt(),l=kt(),b=Ct(),v=e,g=l.meta.title,d=_(0);let r=null;const f=async()=>{try{const i=await xt();d.value=i.data}catch(i){console.error("获取未读消息数量失败:",i),d.value=0}};pe(()=>{v.isLogin!=!0&&(f(),r=window.setInterval(()=>{f()},3e4))}),wt(()=>{r&&clearInterval(r)});const h=()=>{var i;(i=history.state)!=null&&i.back?a.back():a.push("/")},w=window.LANG_COLUMNS,C=_(!1),p=({selectedValues:i})=>{C.value=!1,Ot(i[0]),pt(i[0]),location.reload()},T=()=>{fn({title:t("navbar.logout.title"),message:t("navbar.logout.message")}).then(async()=>{try{await _t(),b.delUser(),a.push("login")}catch(i){console.error("Logout failed:",i)}}).catch(()=>{})},k=()=>{a.push("notification")};return n({fetchUnreadCount:f}),(i,u)=>{const y=yn,x=me,S=on,E=De,Y=hn;return M(),W(Y,{title:v.title??ye(g),fixed:i.fixed,"z-index":"2",style:$e({backgroundColor:v.isLogin?"transparent":"#fff"}),class:"transparent-navbar"},{left:le(()=>[Ce(i.$slots,"left",{},()=>[i.isBack==!0?(M(),W(y,{key:0,name:"back",class:"nav-icon",onClick:u[0]||(u[0]=O=>h())})):q("",!0)],!0)]),right:le(()=>[Ce(i.$slots,"right",{},()=>[Ne("div",Cn,[v.isLang?(M(),W(y,{key:0,name:"language",class:"nav-icon nav-icon2",onClick:u[1]||(u[1]=O=>C.value=!0)})):q("",!0),v.isLogin==!1?(M(),re("div",{key:1,class:"notification-wrapper",onClick:u[3]||(u[3]=O=>k())},[s(x,{name:"bell",class:"nav-icon bell-icon",onClick:u[2]||(u[2]=O=>k())}),d.value>0?(M(),re("div",{key:0,class:Ee(["badge",{"badge-large":d.value>99}])},St(d.value>99?"99+":d.value),3)):q("",!0)])):q("",!0),v.isLoginOut==!0?(M(),W(y,{key:2,name:"logout",class:"nav-icon nav-icon2",onClick:u[4]||(u[4]=O=>T())})):q("",!0)]),s(E,{show:C.value,"onUpdate:show":u[6]||(u[6]=O=>C.value=O),"destroy-on-close":"",round:"",position:"bottom"},{default:le(()=>[s(S,{columns:ye(w),onCancel:u[5]||(u[5]=O=>C.value=!1),onConfirm:p},null,8,["columns"])]),_:1},8,["show"])],!0)]),_:3},8,["title","fixed","style"])}}}),Tn=Re(kn,[["__scopeId","data-v-24174fb5"]]);export{ue as B,on as P,Tn as _,yn as a,Et as b,Me as r,dn as s,Ue as u};
