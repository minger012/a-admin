import{d as dt,V as ct,a as l,w as W,v as pt,W as M,Z as Y,f as i,P as vt,$ as p,aq as _t,a8 as rt,Y as t,a0 as n,a1 as a,S as z,ar as O,I as mt,_ as ft,a4 as ht,as as wt,at as Z,au as yt,av as R,aa as q,ae as gt}from"./index-DoQrIYf3.js";import{P as bt,N as Ct}from"./index-Ct7HaATF.js";import{P as xt,L as kt}from"./index-BuP-3vSl.js";import{B as At,_ as Ut,a as Pt}from"./CpNavBar-DsDodjpW.js";import{a as Vt,u as Bt}from"./common-fNtoFq1c.js";import{T as Tt,a as $t}from"./index-cgialx6W.js";const It={class:"dialog-wrap"},Nt={class:"dialog-title"},St={class:"form-wrap"},Dt={class:"input-wrap"},Lt={class:"label"},Mt={class:"van-cell van-field"},zt={class:"van-cell__value van-field__value"},Ot={class:"van-field__body"},Rt=["placeholder"],qt={class:"form-tips"},Et={class:"count-money"},Ft={class:"title"},Kt={class:"status"},Wt={class:"status-text"},Yt={class:"mt-6"},Zt={class:"font-[600] text-base"},jt={class:"placement-modal"},Gt={class:"modal-header"},Ht={class:"modal-content"},Jt={class:"plan-summary"},Qt={class:"summary-info"},Xt={class:"summary-item"},te={class:"label compact"},ee={class:"value"},se={class:"placement-form"},ae={class:"van-form"},oe={class:"form-field-group"},ne={class:"field-wrapper"},le={class:"field-label"},ie={class:"field-input-wrapper"},ue={class:"currency-symbol"},de=["placeholder"],ce={class:"field-wrapper"},pe={class:"field-label"},ve={class:"field-input-wrapper"},_e=["placeholder"],re={class:"duration-unit"},me={class:"title"},fe={class:"status"},he={class:"status-text"},we={class:"form-tips"},ye={class:"tip-item"},ge={class:"tip-item"},be={class:"form-actions"},Ce={class:"font-[600] text-base"},xe={class:"tab-wrap"},ke={class:"coupon-list"},Ae={role:"feed",class:"van-list","aria-busy":"false"},Ue=["onClick"],Pe={class:"item-left"},Ve={class:"coupon-type"},Be={class:"item-content"},Te={class:"title-line"},$e={class:"title"},Ie={class:"text"},Ne={class:"name"},Se={class:"time"},De={class:"dialog-wrap"},Le={class:"dialog-title"},Me={class:"desc"},ze={class:"text-sm"},Oe=dt({__name:"CpPutin",setup(Re,{expose:j}){const{t:s}=ct(),E=Bt(),G=Vt(),v=l(""),C=l(""),x=l(""),F=l(""),B=l(""),T=l(""),$=l(""),d=l(""),I=l(!0);W(d,u=>{d.value=u.replace(/[^\d]/g,"").slice(0,6),d.value.length==6?I.value=!1:I.value=!0});const K=async()=>{var u,e;if(d.value.length!=6){w.value=!0;return}w.value=!1,x.value?await wt(x.value,v.value,d.value,C.value,((u=m.value)==null?void 0:u.id)||"").then(_=>{A.value=!1,v.value="",C.value="",x.value="",m.value=null,Z(_.msg),N()}).finally(()=>{d.value=""}):await yt($.value,v.value,d.value,((e=m.value)==null?void 0:e.id)||"").then(_=>{U.value=!1,v.value="",$.value="",B.value="",T.value="",m.value=null,Z(_.msg),N()}).finally(()=>{d.value=""})},k=l(),N=async()=>{await _t().then(u=>{k.value=u.data})},r=l({page:0,pageSize:10}),A=l(!1),w=l(!1),U=l(!1),f=l(!1),y=l(0),P=l(!1),S=l(!1),g=l([]),H=async()=>{S.value||(P.value=!0,r.value.page++,await R(r.value,y.value).then(u=>{g.value.push(...u.data.list),r.value.page>=u.data.total_page&&(S.value=!0)}).finally(()=>{P.value=!1}))},h=l(!1),J=async()=>{r.value.page=1,await R(r.value,y.value).then(u=>{g.value=u.data.list,h.value=!1}).catch(()=>{h.value=!1})};W(y,async u=>{r.value.page=1,g.value=[],h.value=!0,await R(r.value,u).then(e=>{g.value=e.data.list}).finally(()=>{h.value=!1})});const m=l(),Q=u=>{u.state==1&&(f.value=!1,m.value=u)},b=l([]),X=async()=>{await rt("1").then(u=>{b.value=u.data})};let tt={1:s("putin.valueAdded"),2:s("putin.deduction"),3:s("putin.team"),4:s("putin.custom"),5:s("putin.fixedAmount")},et={1:s("putin.unused"),2:s("putin.used"),3:s("putin.expired")};return j({showBottom:A,showBottom3:U,plan_id:x,plan_name:F,min:B,max:T,order_id:$}),pt(async()=>{Promise.all([X(),N()])}),(u,e)=>{const _=mt,D=At,V=vt,st=Pt,at=Ut,L=$t,ot=Tt,nt=kt,lt=xt,it=bt,ut=Ct;return q(),M(Y,null,[i(V,{show:U.value,"onUpdate:show":e[4]||(e[4]=o=>U.value=o),round:"",closeable:"",position:"bottom",style:{height:"55%"}},{default:p(()=>{var o;return[t("div",It,[t("div",Nt,n(a(s)("putin.placementAmount")),1),t("div",St,[t("div",Dt,[t("span",Lt,n(b.value[1]),1),t("div",Mt,[t("div",zt,[t("div",Ot,[z(t("input",{type:"text",id:"van-field-8-input",class:"van-field__control",placeholder:B.value+"~"+T.value,"data-allow-mismatch":"attribute","onUpdate:modelValue":e[0]||(e[0]=c=>v.value=c)},null,8,Rt),[[O,v.value]])])])])]),t("div",qt,[t("span",Et,n(a(s)("putin.availableBalance"))+" "+n(b.value[1])+" "+n(a(E).formatMoney(k.value.money)),1),t("span",{class:"all-text",onClick:e[1]||(e[1]=c=>v.value=k.value.money)},n(a(s)("putin.all")),1)]),t("div",{class:"coupon-item",onClick:e[2]||(e[2]=c=>f.value=!0)},[t("span",Ft,n(a(s)("putin.coupon")),1),t("div",Kt,[t("span",Wt,n(((o=m.value)==null?void 0:o.name)||a(s)("putin.unused")),1),i(_,{name:"arrow"})])])]),t("div",Yt,[i(D,{block:"",round:"",type:"primary",onClick:e[3]||(e[3]=c=>K())},{default:p(()=>[t("span",Zt,n(a(s)("putin.realTimePlacement")),1)]),_:1})])])]}),_:1},8,["show"]),i(V,{show:A.value,"onUpdate:show":e[9]||(e[9]=o=>A.value=o),round:"",closeable:"",position:"bottom",style:{height:"70%"}},{default:p(()=>{var o;return[t("div",jt,[t("div",Gt,[t("h3",null,n(a(s)("putin.placementSettings")),1)]),t("div",Ht,[t("div",Jt,[t("h4",null,n(F.value),1),t("div",Qt,[t("div",Xt,[t("span",te,n(a(s)("putin.availableBalance"))+": ",1),t("span",ee,n(b.value[1])+n(a(E).formatMoney(k.value.money)),1)])])]),t("div",se,[t("form",ae,[t("div",oe,[t("div",ne,[t("label",le,n(a(s)("putin.placementAmount")),1),t("div",ie,[t("span",ue,n(b.value[1]),1),z(t("input",{class:"field-input",placeholder:a(s)("putin.enterAmount"),"onUpdate:modelValue":e[5]||(e[5]=c=>v.value=c)},null,8,de),[[O,v.value]])])]),t("div",ce,[t("label",pe,n(a(s)("putin.placementDuration")),1),t("div",ve,[z(t("input",{type:"number",class:"field-input",placeholder:a(s)("putin.enterSeconds"),"onUpdate:modelValue":e[6]||(e[6]=c=>C.value=c)},null,8,_e),[[O,C.value]]),t("span",re,n(a(s)("putin.seconds")),1)])])]),t("div",{class:"coupon-item",onClick:e[7]||(e[7]=c=>f.value=!0)},[t("span",me,n(a(s)("putin.coupon")),1),t("div",fe,[t("span",he,n(((o=m.value)==null?void 0:o.name)||a(s)("putin.unused")),1),i(_,{name:"arrow"})])]),t("div",we,[t("div",ye,[i(_,{name:"info",color:"#4e7cdc"}),t("span",null,n(a(s)("putin.tip1")),1)]),t("div",ge,[i(_,{name:"info",color:"#4e7cdc"}),t("span",null,n(a(s)("putin.tip2")),1)])]),t("div",be,[i(D,{block:"",round:"",type:"primary",onClick:e[8]||(e[8]=c=>w.value=!0)},{default:p(()=>[t("span",Ce,n(a(s)("putin.confirmPlacement")),1)]),_:1})])])])])])]}),_:1},8,["show"]),i(V,{show:f.value,"onUpdate:show":e[14]||(e[14]=o=>f.value=o),position:"bottom",style:{height:"100%"}},{default:p(()=>[i(at,{title:a(s)("putin.coupon")},{left:p(()=>[i(st,{name:"back",size:"1.2019rem",onClick:e[10]||(e[10]=o=>f.value=!1)})]),_:1},8,["title"]),t("div",xe,[i(ot,{active:y.value,"onUpdate:active":e[11]||(e[11]=o=>y.value=o),"line-width":"5.625rem"},{default:p(()=>[i(L,{title:a(s)("putin.all")},null,8,["title"]),i(L,{title:a(s)("putin.unused")},null,8,["title"]),i(L,{title:a(s)("putin.used")},null,8,["title"])]),_:1},8,["active"])]),i(lt,{modelValue:h.value,"onUpdate:modelValue":e[13]||(e[13]=o=>h.value=o),onRefresh:J},{default:p(()=>[i(nt,{loading:P.value,"onUpdate:loading":e[12]||(e[12]=o=>P.value=o),finished:S.value,onLoad:H,"finished-text":a(s)("common.noMore")},{default:p(()=>[t("div",ke,[t("div",Ae,[(q(!0),M(Y,null,ft(g.value,o=>(q(),M("div",{class:ht(["coupon-item",o.state==1?"":"used"]),onClick:c=>Q(o)},[t("div",Pe,[t("div",Ve,n(a(tt)[o.type]),1),e[18]||(e[18]=t("div",{class:"tag"},null,-1))]),t("div",Be,[t("div",Te,[t("div",$e,n(o.name),1),t("span",Ie,n(a(et)[o.state]),1)]),t("div",Ne,n(o.intro),1),t("div",Se,n(a(s)("coupons.validUntil",{date:a(G).formatToMonthDay(o.create_time,1)})),1)])],10,Ue))),256))])])]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["modelValue"])]),_:1},8,["show"]),i(V,{show:w.value,"onUpdate:show":e[17]||(e[17]=o=>w.value=o),position:"bottom",round:"",style:{height:"95%"}},{default:p(()=>[t("div",De,[t("div",Le,n(a(s)("putin.transactionPassword")),1),t("div",Me,n(a(s)("putin.enterTransactionPassword")),1),i(it,{value:d.value,length:6},null,8,["value"]),i(ut,{modelValue:d.value,"onUpdate:modelValue":e[15]||(e[15]=o=>d.value=o),show:!0},null,8,["modelValue"]),i(D,{type:"primary",round:"",block:"",style:{"margin-top":"2rem"},disabled:I.value,onClick:e[16]||(e[16]=o=>K())},{default:p(()=>[t("span",ze,n(a(s)("putin.confirm")),1)]),_:1},8,["disabled"])])]),_:1},8,["show"])],64)}}}),Ze=gt(Oe,[["__scopeId","data-v-eed61532"]]);export{Ze as C};
