import{G as J,t as z,e as M,T as Q,I as F,w as H,n as j,R as oe,Y as se,Z as ne,H as le,j as X,S as ie,$ as re,a0 as ee,a1 as ce,u as G,a2 as ue,i as de,V as pe,a3 as me,P as ve,_ as fe,a4 as ge,a5 as _e,a6 as N}from"./CpNavBar-BVCiNokF.js";import{P as he,L as we}from"./index-uDgtOVEj.js";import{E as ye}from"./index-DBCv_xKa.js";import{C as Ce}from"./index-LRxrsJ4P.js";import{a as ke}from"./common-OH7xm5tF.js";import{u as xe}from"./use-id-Br5nqM4_.js";import{d as A,a as n,T as be,r as _,n as W,G as Pe,D as Oe,s as Se,E as Ve,p as Ie,w as Te,c as B,b as d,h as E,F as K,g as Y,f as $e,x as U,k as ze,t as Z,u as Be,i as V,_ as Ee}from"./index-CmAqP3Ju.js";import"./use-tab-status-1vFvlbEp.js";const[Re,q]=M("tag"),De={size:String,mark:Boolean,show:z,type:J("default"),color:String,plain:Boolean,round:Boolean,textColor:String,closeable:Boolean};var Ae=A({name:Re,props:De,emits:["close"],setup(t,{slots:f,emit:i}){const p=s=>{s.stopPropagation(),i("close",s)},o=()=>t.plain?{color:t.textColor||t.color,borderColor:t.color}:{color:t.textColor,background:t.color},l=()=>{var s;const{type:m,mark:h,plain:w,round:g,size:v,closeable:C}=t,k={mark:h,plain:w,round:g};v&&(k[v]=v);const x=C&&n(F,{name:"cross",class:[q("close"),Q],onClick:p},null);return n("span",{style:o(),class:q([k,m])},[(s=f.default)==null?void 0:s.call(f),x])};return()=>n(be,{name:t.closeable?"van-fade":void 0},{default:()=>[t.show?l():null]})}});const Le=H(Ae),[te,R]=M("dropdown-menu"),Ne={overlay:z,zIndex:j,duration:oe(.2),direction:J("down"),activeColor:String,autoLocate:Boolean,closeOnClickOutside:z,closeOnClickOverlay:z,swipeThreshold:j},ae=Symbol(te);var We=A({name:te,props:Ne,setup(t,{slots:f}){const i=xe(),p=_(),o=_(),l=_(0),{children:s,linkChildren:m}=se(ae),h=ne(p),w=W(()=>s.some(e=>e.state.showWrapper)),g=W(()=>t.swipeThreshold&&s.length>+t.swipeThreshold),v=W(()=>{if(w.value&&le(t.zIndex))return{zIndex:+t.zIndex+1}}),C=()=>{s.forEach(e=>{e.toggle(!1)})},k=()=>{t.closeOnClickOutside&&C()},x=()=>{if(o.value){const e=ee(o);t.direction==="down"?l.value=e.bottom:l.value=ce.value-e.top}},O=()=>{w.value&&x()},I=e=>{s.forEach((a,c)=>{c===e?a.toggle():a.state.showPopup&&a.toggle(!1,{immediate:!0})})},S=(e,a)=>{const{showPopup:c}=e.state,{disabled:u,titleClass:b}=e;return n("div",{id:`${i}-${a}`,role:"button",tabindex:u?void 0:0,"data-allow-mismatch":"attribute",class:[R("item",{disabled:u,grow:g.value}),{[Q]:!u}],onClick:()=>{u||I(a)}},[n("span",{class:[R("title",{down:c===(t.direction==="down"),active:c}),b],style:{color:c?t.activeColor:""}},[n("div",{class:"van-ellipsis"},[e.renderTitle()])])])};return X({close:C}),m({id:i,props:t,offset:l,updateOffset:x}),ie(p,k),re("scroll",O,{target:h,passive:!0}),()=>{var e;return n("div",{ref:p,class:R()},[n("div",{ref:o,style:v.value,class:R("bar",{opened:w.value,scrollable:g.value})},[s.map(S)]),(e=f.default)==null?void 0:e.call(f)])}}});const[Ue,D]=M("dropdown-item"),Me={title:String,options:ue(),disabled:Boolean,teleport:[String,Object],lazyRender:z,modelValue:G,titleClass:G};var Fe=A({name:Ue,inheritAttrs:!1,props:Me,emits:["open","opened","close","closed","change","update:modelValue"],setup(t,{emit:f,slots:i,attrs:p}){const o=Pe({showPopup:!1,transition:!0,showWrapper:!1}),l=_(),{parent:s,index:m}=de(ae);if(!s)return;const h=e=>()=>f(e),w=h("open"),g=h("close"),v=h("opened"),C=()=>{o.showWrapper=!1,f("closed")},k=e=>{t.teleport&&e.stopPropagation()},x=(e=!o.showPopup,a={})=>{e!==o.showPopup&&(o.showPopup=e,o.transition=!a.immediate,e&&(s.updateOffset(),o.showWrapper=!0))},O=()=>{if(i.title)return i.title();if(t.title)return t.title;const e=t.options.find(a=>a.value===t.modelValue);return e?e.text:""},I=e=>{const{activeColor:a}=s.props,{disabled:c}=e,u=e.value===t.modelValue,b=()=>{c||(o.showPopup=!1,e.value!==t.modelValue&&(f("update:modelValue",e.value),f("change",e.value)))},P=()=>{if(u)return n(F,{class:D("icon"),color:c?void 0:a,name:"success"},null)};return n(Ce,{role:"menuitem",key:String(e.value),icon:e.icon,title:e.text,class:D("option",{active:u,disabled:c}),style:{color:u?a:""},tabindex:u?0:-1,clickable:!c,onClick:b},{value:P})},S=()=>{const{offset:e}=s,{autoLocate:a,zIndex:c,overlay:u,duration:b,direction:P,closeOnClickOverlay:L}=s.props,T=pe(c);let $=e.value;if(a&&l.value){const y=me(l.value);y&&($-=ee(y).top)}return P==="down"?T.top=`${$}px`:T.bottom=`${$}px`,Se(n("div",Ie({ref:l,style:T,class:D([P]),onClick:k},p),[n(ve,{show:o.showPopup,"onUpdate:show":y=>o.showPopup=y,role:"menu",class:D("content"),overlay:u,position:P==="down"?"top":"bottom",duration:o.transition?b:0,lazyRender:t.lazyRender,overlayStyle:{position:"absolute"},"aria-labelledby":`${s.id}-${m.value}`,"data-allow-mismatch":"attribute",closeOnClickOverlay:L,onOpen:w,onClose:g,onOpened:v,onClosed:C},{default:()=>{var y;return[t.options.map(I),(y=i.default)==null?void 0:y.call(i)]}})]),[[Ve,o.showWrapper]])};return X({state:o,toggle:x,renderTitle:O}),()=>t.teleport?n(Oe,{to:t.teleport},{default:()=>[S()]}):S()}});const He=H(Fe),je=H(We),Ge={class:"page"},Ke={class:"filter-section"},Ye={class:"message-list"},Ze={class:"p-3 h-full"},qe=["onClick"],Je={class:"text-10"},Qe={class:"message-time"},Xe={key:0,class:"unread-dot"},et={class:"message-item-content"},tt={class:"message-icon-wrapper"},at=A({__name:"notification",setup(t){const f=ke(),i=_({page:0,pageSize:10}),p=_(!1),o=_(!1),l=_([]),s=async()=>{o.value||(p.value=!0,i.value.page++,await N(i.value,g.value,v.value).then(e=>{l.value.push(...e.data.list),i.value.page>=e.data.total_page&&(o.value=!0),p.value=!1}).catch(()=>{p.value=!1}))},m=_(!1),h=async()=>{i.value.page=1,await N(i.value,g.value,v.value).then(e=>{l.value=e.data.list,m.value=!1}).catch(()=>{m.value=!1})},w=e=>{e.read_time==0&&(ge(e.id),l.value=l.value.map(a=>(a.id==e.id&&(a.read_time=1),a))),_e({title:e.title,message:e.content}).then(()=>{})},g=_(0),v=_(0);Te([g,v],async([e,a])=>{i.value.page=1,l.value=[],m.value=!0,await N(i.value,e,a).then(c=>{l.value=c.data.list,m.value=!1}).catch(()=>{m.value=!1})});const C=[{text:"全部消息",value:0},{text:"系统公告",value:1},{text:"系统维护",value:2},{text:"活动通知",value:3}],k=[{text:"全部状态",value:0},{text:"未读消息",value:1},{text:"已读消息",value:2}],x={1:"系统公告",2:"系统维护",3:"活动通知"},O={1:"icon-blue",2:"icon-orange",3:"icon-red"},I={1:"primary",2:"warning",3:"danger"},S={1:"volume-o",2:"setting-o",3:"gift-o"};return(e,a)=>{const c=fe,u=He,b=je,P=ye,L=Le,T=F,$=we,y=he;return V(),B(K,null,[n(c),d("div",Ge,[d("div",Ke,[n(b,{"swipe-threshold":"2"},{default:E(()=>[n(u,{modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=r=>g.value=r),options:C},null,8,["modelValue"]),n(u,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=r=>v.value=r),options:k},null,8,["modelValue"])]),_:1})]),d("div",Ye,[n(y,{modelValue:m.value,"onUpdate:modelValue":a[3]||(a[3]=r=>m.value=r),onRefresh:h,"pulling-text":"Pull down to refresh...","loosing-text":"Release to refresh...","loading-text":"loading..."},{default:E(()=>[l.value?(V(),Y($,{key:1,loading:p.value,"onUpdate:loading":a[2]||(a[2]=r=>p.value=r),finished:o.value,"finished-text":"no more","loading-text":"loading...","error-text":"fail",onLoad:s},{default:E(()=>[d("div",Ze,[(V(!0),B(K,null,$e(l.value,r=>(V(),B("div",{class:"message-item type-system_announcement",onClick:ot=>w(r)},[d("div",{class:U(["message-item-header",r.read_time==0?"unread":""])},[d("div",{class:U(["message-type-indicator",O[r.type]])},null,2),n(L,{type:I[r.type]},{default:E(()=>[d("span",Je,Z(x[r.type]),1)]),_:2},1032,["type"]),d("span",Qe,Z(Be(f).timeAgo(r.create_time)),1),r.read_time==0?(V(),B("div",Xe)):ze("",!0)],2),d("div",et,[d("div",tt,[d("div",{class:U(["message-icon",O[r.type]])},[n(T,{name:S[r.type],size:"1.125rem"},null,8,["name"])],2)]),a[4]||(a[4]=d("div",{class:"message-body"},[d("h3",{class:"message-title"},"ni kkk"),d("p",{class:"message-text"},"ni kkk")],-1))])],8,qe))),256))])]),_:1},8,["loading","finished"])):(V(),Y(P,{key:0,description:"暂无消息"}))]),_:1},8,["modelValue"])])])],64)}}}),pt=Ee(at,[["__scopeId","data-v-4ad12ec7"]]);export{pt as default};
