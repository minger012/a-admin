var b=(_,m,r)=>new Promise((p,d)=>{var n=e=>{try{u(r.next(e))}catch(c){d(c)}},i=e=>{try{u(r.throw(e))}catch(c){d(c)}},u=e=>e.done?p(e.value):Promise.resolve(e.value).then(n,i);u((r=r.apply(_,m)).next())});import{d as S,u as U,r as v,b as E,aa as y,o as M,x as q,w as t,j as o,i as P,dS as N,k as R,l as V,_ as j,B as T,D as z,E as A}from"./index-BEDOAs2M.js";const H=S({__name:"EditPwdModal",props:{visible:{type:Boolean},userData:{}},emits:["update:visible","success"],setup(_,{emit:m}){const r=U(),p=v(),d=v(!1),n=v(!1),i=_,u=m,e=E({id:0,password:"",confirmPassword:""}),h={password:{required:!0,message:"请输入新密码",trigger:["blur","input"]},confirmPassword:{required:!0,validator:(a,s)=>s!==e.password?new Error("两次输入的密码不一致"):!0,trigger:["blur","input"]}};y(()=>i.visible,a=>{n.value=a,a&&i.userData&&(e.id=i.userData.id,e.password="",e.confirmPassword="")}),y(n,a=>{u("update:visible",a)});const k=()=>{n.value=!1},x=()=>b(this,null,function*(){var a;try{yield(a=p.value)==null?void 0:a.validate(),d.value=!0;const s=yield N({id:e.id,password:e.password});s.code===1?(r.success("密码修改成功"),n.value=!1,u("success")):r.error(s.msg||"密码修改失败")}catch(s){console.error("表单提交错误:",s)}finally{d.value=!1}});return(a,s)=>{const f=R,w=V,B=j,g=T,C=z,D=A;return M(),q(D,{show:n.value,"onUpdate:show":s[2]||(s[2]=l=>n.value=l),"show-icon":!1,preset:"dialog",title:"修改登录密码",style:{width:"500px"}},{action:t(()=>[o(C,null,{default:t(()=>[o(g,{onClick:k},{default:t(()=>s[3]||(s[3]=[P("取消")])),_:1}),o(g,{type:"primary",loading:d.value,onClick:x},{default:t(()=>s[4]||(s[4]=[P("确定")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[o(B,{model:e,rules:h,ref_key:"formRef",ref:p,"label-placement":"left","label-width":100,class:"py-4"},{default:t(()=>[o(w,{label:"用户名"},{default:t(()=>{var l;return[o(f,{value:(l=a.userData)==null?void 0:l.username,disabled:""},null,8,["value"])]}),_:1}),o(w,{label:"新密码",path:"password"},{default:t(()=>[o(f,{type:"password","show-password-on":"click",placeholder:"请输入新密码",value:e.password,"onUpdate:value":s[0]||(s[0]=l=>e.password=l)},null,8,["value"])]),_:1}),o(w,{label:"确认密码",path:"confirmPassword"},{default:t(()=>[o(f,{type:"password","show-password-on":"click",placeholder:"请再次输入新密码",value:e.confirmPassword,"onUpdate:value":s[1]||(s[1]=l=>e.confirmPassword=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])}}});export{H as _};
