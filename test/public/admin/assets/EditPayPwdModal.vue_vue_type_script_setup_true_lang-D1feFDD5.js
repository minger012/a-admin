var g=(c,m,r)=>new Promise((p,d)=>{var n=e=>{try{u(r.next(e))}catch(_){d(_)}},i=e=>{try{u(r.throw(e))}catch(_){d(_)}},u=e=>e.done?p(e.value):Promise.resolve(e.value).then(n,i);u((r=r.apply(c,m)).next())});import{d as U,u as E,r as v,b as M,aa as b,o as S,x as q,w as t,j as o,i as P,dT as N,k as R,l as T,_ as V,B as j,D as z,E as A}from"./index--W9FB2Si.js";const H=U({__name:"EditPayPwdModal",props:{visible:{type:Boolean},userData:{}},emits:["update:visible","success"],setup(c,{emit:m}){const r=E(),p=v(),d=v(!1),n=v(!1),i=c,u=m,e=M({id:0,pay_password:"",confirmPassword:""}),h={pay_password:{required:!0,message:"请输入新支付密码",trigger:["blur","input"]},confirmPassword:{required:!0,validator:(s,a)=>a!==e.pay_password?new Error("两次输入的密码不一致"):!0,trigger:["blur","input"]}};b(()=>i.visible,s=>{n.value=s,s&&i.userData&&(e.id=i.userData.id,e.pay_password="",e.confirmPassword="")}),b(n,s=>{u("update:visible",s)});const k=()=>{n.value=!1},x=()=>g(this,null,function*(){var s;try{yield(s=p.value)==null?void 0:s.validate(),d.value=!0;const a=yield N({id:e.id,pay_password:e.pay_password});a.code===1?(r.success("支付密码修改成功"),n.value=!1,u("success")):r.error(a.msg||"支付密码修改失败")}catch(a){console.error("表单提交错误:",a)}finally{d.value=!1}});return(s,a)=>{const f=R,w=T,B=V,y=j,C=z,D=A;return S(),q(D,{show:n.value,"onUpdate:show":a[2]||(a[2]=l=>n.value=l),"show-icon":!1,preset:"dialog",title:"修改支付密码",style:{width:"500px"}},{action:t(()=>[o(C,null,{default:t(()=>[o(y,{onClick:k},{default:t(()=>a[3]||(a[3]=[P("取消")])),_:1}),o(y,{type:"primary",loading:d.value,onClick:x},{default:t(()=>a[4]||(a[4]=[P("确定")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[o(B,{model:e,rules:h,ref_key:"formRef",ref:p,"label-placement":"left","label-width":100,class:"py-4"},{default:t(()=>[o(w,{label:"用户名"},{default:t(()=>{var l;return[o(f,{value:(l=s.userData)==null?void 0:l.username,disabled:""},null,8,["value"])]}),_:1}),o(w,{label:"新支付密码",path:"pay_password"},{default:t(()=>[o(f,{type:"password","show-password-on":"click",placeholder:"请输入新支付密码",value:e.pay_password,"onUpdate:value":a[0]||(a[0]=l=>e.pay_password=l),maxlength:"6"},null,8,["value"])]),_:1}),o(w,{label:"确认支付密码",path:"confirmPassword"},{default:t(()=>[o(f,{type:"password","show-password-on":"click",placeholder:"请再次输入支付密码",value:e.confirmPassword,"onUpdate:value":a[1]||(a[1]=l=>e.confirmPassword=l),maxlength:"6"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])}}});export{H as _};
