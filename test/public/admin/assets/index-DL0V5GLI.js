var ge=Object.defineProperty;var J=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var Q=(d,s,n)=>s in d?ge(d,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[s]=n,ee=(d,s)=>{for(var n in s||(s={}))be.call(s,n)&&Q(d,n,s[n]);if(J)for(var n of J(s))we.call(s,n)&&Q(d,n,s[n]);return d};var F=(d,s,n)=>new Promise((e,y)=>{var $=v=>{try{w(n.next(v))}catch(D){y(D)}},U=v=>{try{w(n.throw(v))}catch(D){y(D)}},w=v=>v.done?e(v.value):Promise.resolve(v.value).then($,U);w((n=n.apply(d,s)).next())});import{B as xe}from"./Table-BxPYim8H.js";import{d as W,o as T,c as Y,a as N,s as p,B as b,D as K,v as ke,u as H,b as le,r as f,x as I,w as a,j as l,i as P,z as L,h as c,U as S,a4 as X,N as G,y as Z,a5 as ae,F as Pe,G as Ce,l as ne,C as oe,$ as ue,n as ie,a6 as $e,X as Ue,q as se,K as De,V as ze,a7 as Me,Y as Be,Z as Te,E as Se,a8 as Ne,a9 as Ae}from"./index--W9FB2Si.js";import{_ as Ie}from"./BasicForm-QjO4c9-O.js";import{u as Re}from"./useForm-BHF_BjGC.js";import{_ as Ve}from"./EditUserModal.vue_vue_type_script_setup_true_lang-C-hoTKFN.js";import{_ as qe}from"./EditPwdModal.vue_vue_type_script_setup_true_lang-D4twb5d0.js";import{_ as Oe}from"./EditPayPwdModal.vue_vue_type_script_setup_true_lang-D1feFDD5.js";import{_ as Ee}from"./ViewBankModal.vue_vue_type_script_setup_true_lang-Ca_kha3d.js";import{_ as Fe}from"./EditBankModal.vue_vue_type_script_setup_true_lang-DDBkE_6z.js";import{_ as Le}from"./RechargeModal.vue_vue_type_script_setup_true_lang-D_NeahKK.js";import{_ as je}from"./DeductModal.vue_vue_type_script_setup_true_lang-CIObHOeb.js";import{_ as Ge}from"./SendCouponModal.vue_vue_type_script_setup_true_lang-C5-c4a2U.js";import{p as re}from"./plan-vryGIZvw.js";import{P as de}from"./PlusOutlined-DRSj6shY.js";import{D as pe}from"./DeleteOutlined-I43YizUE.js";import"./vuedraggable.umd-B1pj_Zeo.js";import"./useDesignSetting-BH2ledVX.js";import"./propTypes-DHDRA3s2.js";import"./componentSetting-CQq0JJwW.js";import"./index-Tz6qLsBu.js";import"./DownOutlined-CqNoZsnt.js";import"./coupon-BE4e-etT.js";const Ke={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},We=N("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4l-66.1-.3c-4.4 0-8 3.5-8 8c0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4l66 .3c4.4 0 8-3.5 8-8c0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z",fill:"currentColor"},null,-1),Xe=N("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448s448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1),Ye=[We,Xe],Ze=W({name:"CloseCircleOutlined",render:function(s,n){return T(),Y("svg",Ke,Ye)}}),He={0:"停用",1:"正常",2:"未激活"},Je={0:"error",1:"success",2:"warning"},te=d=>{d&&window.open(d)},Qe=d=>[{title:"用户ID",key:"id",width:100,fixed:"left"},{title:"用户名",key:"username",width:120,fixed:"left"},{title:"用户昵称",key:"name",width:120},{title:"用户简称",key:"short_name",width:120},{title:"头像",key:"image",width:120,render(s){return s.image?p("img",{src:s.image,style:{width:"80px",height:"80px",borderRadius:"50%"}}):""}},{title:"手机号",key:"phone",width:130},{title:"所属管理者",key:"admin_name",width:120},{title:"授权码",key:"code",width:120},{title:"上级用户ID",key:"pid",width:120},{title:"代理管理",key:"agent_management",width:100,render(s){return p(b,{text:!0,type:"primary",size:"small"},{default:()=>"查看"})}},{title:"语言偏好",key:"lang",width:100},{title:"FB_ID",key:"fb_id",width:180},{title:"提现方式",key:"bank",width:150,render(s){return p(K,{size:"small"},{default:()=>[p(b,{text:!0,type:"primary",size:"small",onClick:()=>{var n;return(n=d==null?void 0:d.onViewBank)==null?void 0:n.call(d,s)}},{default:()=>"查看"}),p(b,{text:!0,type:"info",size:"small",onClick:()=>{var n;return(n=d==null?void 0:d.onEditBank)==null?void 0:n.call(d,s)}},{default:()=>"编辑"})]})}},{title:"可用余额",key:"money",width:120,render(s){return`¥${(s.money||0).toFixed(2)}`}},{title:"状态",key:"state",width:100,render(s){return p(ke,{type:Je[s.state]||"default",bordered:!1},{default:()=>He[s.state]||"未知"})}},{title:"用户视角",key:"user_perspective",width:120,render(s){return p(K,{size:"small",vertical:!0},{default:()=>[p(b,{text:!0,type:"primary",size:"small",onClick:()=>{var n;return te((n=s.gmUrl)==null?void 0:n.market)}},{default:()=>"广告中心"}),p(b,{text:!0,type:"info",size:"small",onClick:()=>{var n;return te((n=s.gmUrl)==null?void 0:n.order)}},{default:()=>"计划管理"})]})}},{title:"用户IP",key:"last_login_ip",width:140}],et={class:"border-[1px] rounded-lg"},tt={class:"flex justify-between p-3 border-b-[1px] border-[#e7e7e7]"},lt={class:"font-semibold text-base"},at={class:"p-3"},nt=W({__name:"BatchDispatch",props:{uid:{}},setup(d){const s=d,n=H(),e=le({matchType:"all",amountType:"fixed",minAmount:null,maxAmount:null,batchCount:1,officialPush:!1,rate:null,releaseTime:null,selectedPlans:[]}),y=f([]),$=f(!1),U=f(!1),w=f(!1),v=f([]),D=f([]),R=[{title:"序号",key:"index",width:80,render:(u,t)=>t+1},{title:"计划名称",key:"plan_name",width:160,render:u=>`${u.plan_id}:${u.plan_name}`},{title:"金额范围",key:"amount",width:120,render:u=>`¥${u.min} - ¥${u.max}`},{title:"利润率",key:"rate",width:120,render:u=>p(S,{value:u.rate,onUpdateValue:t=>{u.rate=t!=null?t:0},min:0,suffix:()=>"%",style:{width:"100%"}})},{title:"投放时间",key:"cd",width:120,render:u=>p(S,{value:u.cd,onUpdateValue:t=>{u.cd=t!=null?t:0},min:0,suffix:()=>"分",style:{width:"100%"}})},{title:"官方推送",key:"officialPush",width:100,render:u=>p(X,{value:u.officialPush,onUpdateValue:t=>{u.officialPush=t}})},{title:"操作",key:"action",width:70,fixed:"right",render:(u,t)=>p(b,{text:!0,type:"error",onClick:()=>i(t)},{icon:()=>p(G,null,{default:()=>p(pe)})})}];function B(){return F(this,null,function*(){w.value=!0;try{const u=yield re({page:"1",pageSize:"999999",state:1});u.code===1&&(v.value=u.data.list||[],D.value=v.value.map(t=>({label:`${t.id}:${t.name}`,value:t.id})))}catch(u){console.error("获取计划列表失败:",u)}finally{w.value=!1}})}function V(u,t,g){if(g==="fixed")return[u,t];if(t-u<100)return[u,t];const A=t-100,x=Math.floor(Math.random()*(A-u+1))+u,O=Math.floor((t-x)/100),k=Math.floor(Math.random()*O)+1,_=x+k*100;return[x,Math.min(_,t)]}function q(){return F(this,null,function*(){if(!e.minAmount||!e.maxAmount){n.error("请输入金额范围");return}if(e.minAmount>=e.maxAmount){n.error("最低金额必须小于最高金额");return}if(!e.batchCount||e.batchCount<1){n.error("请输入有效的批量数量");return}if(e.matchType==="random"&&e.selectedPlans.length===0){n.error("请至少选择一个计划");return}$.value=!0;try{if(v.value.length===0&&(yield B()),v.value.length===0){n.error("没有可用的计划");return}let u=[];if(e.matchType==="all"?u=v.value:u=v.value.filter(g=>e.selectedPlans.includes(g.id)),u.length===0){n.error("没有可用的计划");return}const t=[];for(let g=0;g<e.batchCount;g++){const C=u[Math.floor(Math.random()*u.length)],[A,x]=V(e.minAmount,e.maxAmount,e.amountType);t.push({plan_id:C.id,plan_name:C.name,min:A,max:x,cd:e.releaseTime||0,officialPush:e.officialPush,rate:e.rate||0})}y.value.push(...t),n.success(`已生成 ${t.length} 个计划，当前共 ${y.value.length} 个`)}catch(u){n.error("生成计划失败"),console.error(u)}finally{$.value=!1}})}function i(u){y.value.splice(u,1)}function o(){y.value=[]}function z(){return F(this,null,function*(){if(y.value.length===0){n.error("请先生成计划");return}U.value=!0;try{const u={uid:s.uid,plan:y.value.map(g=>({plan_id:g.plan_id,min:g.min,max:g.max,cd:g.cd,form:g.officialPush?2:1,rate:g.rate}))},t=yield ae(u);t.code===1?(n.success("派单成功"),y.value=[],e.minAmount=null,e.maxAmount=null,e.batchCount=1,e.rate=null,e.releaseTime=null):n.error(t.msg||"派单失败")}catch(u){n.error("派单失败"),console.error(u)}finally{U.value=!1}})}return B(),(u,t)=>{const g=Pe,C=K,A=Ce,x=ne,O=oe,k=ue;return T(),I(C,{class:"pt-3",vertical:""},{default:a(()=>[l(x,{label:"计划匹配方式"},{default:a(()=>[l(A,{value:e.matchType,"onUpdate:value":t[0]||(t[0]=_=>e.matchType=_)},{default:a(()=>[l(C,null,{default:a(()=>[l(g,{value:"all"},{default:a(()=>t[9]||(t[9]=[P("全部随机匹配")])),_:1}),l(g,{value:"random"},{default:a(()=>t[10]||(t[10]=[P("指定计划随机")])),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),e.matchType==="random"?(T(),I(x,{key:0,label:"选择计划范围",required:""},{default:a(()=>[l(O,{value:e.selectedPlans,"onUpdate:value":t[1]||(t[1]=_=>e.selectedPlans=_),multiple:"",filterable:"",options:D.value,placeholder:"请选择计划",loading:w.value,clearable:""},null,8,["value","options","loading"])]),_:1})):L("",!0),l(x,{label:"金额设置方式"},{default:a(()=>[l(A,{value:e.amountType,"onUpdate:value":t[2]||(t[2]=_=>e.amountType=_)},{default:a(()=>[l(C,null,{default:a(()=>[l(g,{value:"fixed"},{default:a(()=>t[11]||(t[11]=[P("固定金额的范围")])),_:1}),l(g,{value:"random"},{default:a(()=>t[12]||(t[12]=[P("范围内随机(100整数)")])),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),l(C,null,{default:a(()=>[l(x,{label:"最低",required:""},{default:a(()=>[l(c(S),{value:e.minAmount,"onUpdate:value":t[3]||(t[3]=_=>e.minAmount=_),min:0,placeholder:"请输入最低金额","show-button":!1,style:{width:"200px"}},{prefix:a(()=>t[13]||(t[13]=[P("¥")])),_:1},8,["value"])]),_:1}),l(x,{label:"最高",required:""},{default:a(()=>[l(c(S),{value:e.maxAmount,"onUpdate:value":t[4]||(t[4]=_=>e.maxAmount=_),min:0,placeholder:"请输入最高金额","show-button":!1,style:{width:"200px"}},{prefix:a(()=>t[14]||(t[14]=[P("¥")])),_:1},8,["value"])]),_:1})]),_:1}),l(C,null,{default:a(()=>[l(x,{label:"批量数量",required:""},{default:a(()=>[l(c(S),{value:e.batchCount,"onUpdate:value":t[5]||(t[5]=_=>e.batchCount=_),min:1,placeholder:"请输入批量数量","show-button":!1,style:{width:"200px"}},null,8,["value"])]),_:1}),l(x,{label:"官方推送"},{default:a(()=>[l(c(X),{value:e.officialPush,"onUpdate:value":t[6]||(t[6]=_=>e.officialPush=_)},null,8,["value"])]),_:1})]),_:1}),l(C,null,{default:a(()=>[l(x,{label:"投放利润"},{default:a(()=>[l(c(S),{value:e.rate,"onUpdate:value":t[7]||(t[7]=_=>e.rate=_),min:0,placeholder:"请输入利润率",style:{width:"200px"},"show-button":!1},{suffix:a(()=>t[15]||(t[15]=[P("%")])),_:1},8,["value"])]),_:1}),l(x,{label:"投放时间"},{default:a(()=>[l(c(S),{value:e.releaseTime,"onUpdate:value":t[8]||(t[8]=_=>e.releaseTime=_),min:0,placeholder:"请输入投放时间",style:{width:"200px"},"show-button":!1},{suffix:a(()=>t[16]||(t[16]=[P("分钟")])),_:1},8,["value"])]),_:1})]),_:1}),l(c(b),{type:"primary",class:"mb-3",onClick:q,loading:$.value},{icon:a(()=>[l(c(G),null,{default:a(()=>[l(c(de))]),_:1})]),default:a(()=>[t[17]||(t[17]=P(" 生成计划 "))]),_:1},8,["loading"]),N("div",et,[N("div",tt,[N("div",lt,"批量已添加计划汇总（"+Z(y.value.length)+"）",1),l(C,null,{default:a(()=>[l(c(b),{text:"",type:"error",onClick:o},{default:a(()=>t[18]||(t[18]=[P(" 清除全部 ")])),_:1})]),_:1})]),N("div",at,[l(k,{columns:R,data:y.value,pagination:!1,bordered:!1,"scroll-x":960},null,8,["data"])])]),y.value.length>0?(T(),I(c(b),{key:1,type:"primary",size:"large",onClick:z,loading:U.value,class:"mt-3",block:""},{default:a(()=>t[19]||(t[19]=[P(" 派单 ")])),_:1},8,["loading"])):L("",!0)]),_:1})}}}),ot=ie(nt,[["__scopeId","data-v-08e4bc2c"]]),ut={class:"flex items-center justify-between"},it={class:"font-medium"},st={key:2,class:"border-[1px] rounded-lg"},rt={class:"flex justify-between p-3 border-b-[1px] border-[#e7e7e7]"},dt={class:"font-semibold text-base"},pt={class:"p-3"},ct=W({__name:"ManualDispatch",props:{uid:{}},setup(d){const s=d,n=H(),e=f([]),y=f(!1),$=f(!1),U=f([]),w=f([]),v=[{title:"序号",key:"index",width:80,render:(i,o)=>o+1},{title:"计划名称",key:"plan_name",width:160,render:i=>{const o=U.value.find(z=>z.id===i.plan_id);return o?`${o.id}:${o.name}`:"-"}},{title:"金额范围",key:"amount",width:120,render:i=>`¥${i.min||0} - ¥${i.max||0}`},{title:"利润率",key:"rate",width:120,render:i=>p(S,{value:i.rate,onUpdateValue:o=>{i.rate=o!=null?o:0},min:0,showButton:!1,suffix:()=>"%",style:{width:"100%"}})},{title:"投放时间",key:"cd",width:120,render:i=>p(S,{value:i.cd,onUpdateValue:o=>{i.cd=o!=null?o:0},min:0,showButton:!1,suffix:()=>"分",style:{width:"100%"}})},{title:"官方推送",key:"officialPush",width:100,render:i=>p(X,{value:i.officialPush,onUpdateValue:o=>{i.officialPush=o}})},{title:"操作",key:"action",width:70,fixed:"right",render:(i,o)=>p(b,{text:!0,type:"error",onClick:()=>B(o)},{icon:()=>p(G,null,{default:()=>p(pe)})})}];function D(){return F(this,null,function*(){$.value=!0;try{const i=yield re({page:"1",pageSize:"999999",state:1});i.code===1&&(U.value=i.data.list||[],w.value=U.value.map(o=>({label:`${o.id}:${o.name}`,value:o.id})))}catch(i){console.error("获取计划列表失败:",i)}finally{$.value=!1}})}function R(){e.value.push({plan_id:null,min:null,max:null,cd:null,officialPush:!1,rate:null})}function B(i){e.value.splice(i,1)}function V(){e.value=[]}function q(){return F(this,null,function*(){for(let i=0;i<e.value.length;i++){const o=e.value[i];if(!o.plan_id){n.error(`计划 #${i+1}: 请选择计划`);return}if(o.min===null||o.min===void 0){n.error(`计划 #${i+1}: 请输入最低金额`);return}if(o.max===null||o.max===void 0){n.error(`计划 #${i+1}: 请输入最高金额`);return}if(o.min>=o.max){n.error(`计划 #${i+1}: 最低金额必须小于最高金额`);return}if(o.cd===null||o.cd===void 0){n.error(`计划 #${i+1}: 请输入投放时间`);return}if(o.rate===null||o.rate===void 0){n.error(`计划 #${i+1}: 请输入投放利润`);return}}y.value=!0;try{const i={uid:s.uid,plan:e.value.map(z=>({plan_id:z.plan_id,min:z.min,max:z.max,cd:z.cd,form:z.officialPush?2:1,rate:z.rate}))},o=yield ae(i);o.code===1?(n.success("派单成功"),e.value=[]):n.error(o.msg||"派单失败")}catch(i){n.error("派单失败"),console.error(i)}finally{y.value=!1}})}return D(),(i,o)=>{const z=oe,u=ne,t=K,g=se,C=De,A=ze,x=Me,O=ue;return T(),I(t,{vertical:""},{default:a(()=>[N("div",ut,[N("span",it,"已添加计划 ("+Z(e.value.length)+")",1),l(c(b),{size:"small",onClick:R},{icon:a(()=>[l(c(G),null,{default:a(()=>[l(c(de))]),_:1})]),default:a(()=>[o[0]||(o[0]=P(" 添加计划 "))]),_:1})]),e.value.length>0?(T(),I(A,{key:0,cols:2,"x-gap":12,"y-gap":12},{default:a(()=>[(T(!0),Y(Ue,null,$e(e.value,(k,_)=>(T(),I(C,{key:_},{default:a(()=>[l(g,{size:"small",title:`计划 #${_+1}`},{"header-extra":a(()=>[l(c(b),{text:"",type:"error",onClick:M=>B(_)},{icon:a(()=>[l(c(G),null,{default:a(()=>[l(c(Ze))]),_:1})]),_:2},1032,["onClick"])]),default:a(()=>[l(t,{vertical:""},{default:a(()=>[l(u,{label:"计划选择",required:""},{default:a(()=>[l(z,{value:k.plan_id,"onUpdate:value":M=>k.plan_id=M,filterable:"",options:w.value,placeholder:"请选择计划",loading:$.value},null,8,["value","onUpdate:value","options","loading"])]),_:2},1024),l(t,null,{default:a(()=>[l(u,{label:"最低",required:""},{default:a(()=>[l(c(S),{value:k.min,"onUpdate:value":M=>k.min=M,min:0,"show-button":!1,placeholder:"最低金额",style:{width:"180px"}},{prefix:a(()=>o[1]||(o[1]=[P("¥")])),_:2},1032,["value","onUpdate:value"])]),_:2},1024),l(u,{label:"最高",required:""},{default:a(()=>[l(c(S),{value:k.max,"onUpdate:value":M=>k.max=M,min:0,"show-button":!1,placeholder:"最高金额",style:{width:"180px"}},{prefix:a(()=>o[2]||(o[2]=[P("¥")])),_:2},1032,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),l(u,{label:"官方推送"},{default:a(()=>[l(c(X),{value:k.officialPush,"onUpdate:value":M=>k.officialPush=M},null,8,["value","onUpdate:value"])]),_:2},1024),l(t,null,{default:a(()=>[l(u,{label:"投放利润",required:""},{default:a(()=>[l(c(S),{value:k.rate,"onUpdate:value":M=>k.rate=M,min:0,"show-button":!1,placeholder:"利润率",style:{width:"180px"}},{suffix:a(()=>o[3]||(o[3]=[P("%")])),_:2},1032,["value","onUpdate:value"])]),_:2},1024),l(u,{label:"投放时间",required:""},{default:a(()=>[l(c(S),{value:k.cd,"onUpdate:value":M=>k.cd=M,min:0,"show-button":!1,placeholder:"投放时间",style:{width:"180px"}},{suffix:a(()=>o[4]||(o[4]=[P("分钟")])),_:2},1032,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1})):L("",!0),e.value.length===0?(T(),I(x,{key:1,description:"暂无计划，点击上方【添加计划】按钮开始添加",style:{padding:"60px 0"}})):L("",!0),e.value.length>0?(T(),Y("div",st,[N("div",rt,[N("div",dt,"手动已添加计划汇总（"+Z(e.value.length)+"）",1),l(t,null,{default:a(()=>[l(c(b),{text:"",type:"error",onClick:V},{default:a(()=>o[5]||(o[5]=[P(" 清除全部 ")])),_:1})]),_:1})]),N("div",pt,[l(O,{columns:v,data:e.value,pagination:!1,bordered:!1,"scroll-x":960},null,8,["data"])])])):L("",!0),e.value.length>0?(T(),I(c(b),{key:3,type:"primary",size:"large",onClick:q,loading:y.value,class:"mt-3",block:""},{default:a(()=>o[6]||(o[6]=[P(" 派单 ")])),_:1},8,["loading"])):L("",!0)]),_:1})}}}),mt=ie(ct,[["__scopeId","data-v-6a84b007"]]),ft=W({__name:"index",props:{uid:{}},setup(d,{expose:s}){const n=f(!1),e=f("batch");function y(){n.value=!0,e.value="batch"}function $(){n.value=!1}return s({open:y,close:$}),(U,w)=>{const v=Be,D=Te,R=Se;return T(),I(R,{show:n.value,"onUpdate:show":w[1]||(w[1]=B=>n.value=B),preset:"card",title:"派单",style:{width:"1100px"},"mask-closable":!1},{default:a(()=>[l(D,{value:e.value,"onUpdate:value":w[0]||(w[0]=B=>e.value=B),type:"card"},{default:a(()=>[l(v,{name:"batch",tab:"批量派单"},{default:a(()=>[l(ot,{uid:U.uid},null,8,["uid"])]),_:1}),l(v,{name:"manual",tab:"手动派单"},{default:a(()=>[l(mt,{uid:U.uid},null,8,["uid"])]),_:1})]),_:1},8,["value"])]),_:1},8,["show"])}}}),Vt=W({__name:"index",setup(d){const s=H(),n=f(),e=f(null),y=f(),$=f(0),U=Qe({onViewBank:r=>k(r),onEditBank:r=>_(r)}),w=f(!1),v=f(!1),D=f(!1),R=f(!1),B=f(!1),V=f(!1),q=f(!1),i=f(!1),o=f({}),z=[{field:"uid",component:"NInput",label:"用户ID",componentProps:{placeholder:"请输入用户ID"}},{field:"fb_id",component:"NInput",label:"FB_ID",componentProps:{placeholder:"请输入FB_ID"}},{field:"username",component:"NInput",label:"用户名",componentProps:{placeholder:"请输入用户名"}},{field:"admin_username",component:"NInput",label:"所属管理者",componentProps:{placeholder:"请输入所属管理者"}},{field:"name",component:"NInput",label:"用户昵称",componentProps:{placeholder:"请输入用户昵称"}},{field:"short_name",component:"NInput",label:"用户简称",componentProps:{placeholder:"请输入用户简称"}},{field:"lang",component:"NInput",label:"语言偏好",componentProps:{placeholder:"请输入语言偏好"}},{field:"timeRange",component:"NDatePicker",label:"创建时间",componentProps:{type:"daterange",clearable:!0,shortcuts:{一周内:[Date.now()-7*24*60*60*1e3,Date.now()],一个月内:[Date.now()-30*24*60*60*1e3,Date.now()],三个月内:[Date.now()-90*24*60*60*1e3,Date.now()]}}}],u=le({width:120,title:"操作",key:"action",fixed:"right",render(r){const h=[{label:"修改密码",key:"editPwd",props:{onClick:()=>x(r)}},{label:"修改支付密码",key:"editPayPwd",props:{onClick:()=>O(r)}}];return p(K,{vertical:!0,size:"small"},{default:()=>[p(b,{text:!0,type:"primary",size:"small",onClick:()=>M(r)},{default:()=>"充值"}),p(b,{text:!0,type:"primary",size:"small",onClick:()=>ce(r)},{default:()=>"扣款"}),p(b,{text:!0,type:"primary",size:"small",onClick:()=>me(r)},{default:()=>"派优惠券"}),p(b,{text:!0,type:"info",size:"small",onClick:()=>fe(r)},{default:()=>"派单"}),p(b,{text:!0,type:"primary",size:"small",onClick:()=>A(r)},{default:()=>"编辑"}),p(Ne,{options:h,trigger:"click"},{default:()=>p(b,{text:!0,type:"primary",size:"small"},{default:()=>"更多"})})]})}}),[t]=Re({gridProps:{cols:"1 s:1 m:2 l:3 xl:4 2xl:4"},labelWidth:120,schemas:z});function g(he){return F(this,arguments,function*({page:r,pageSize:h}){const m=ee({page:String(r),pageSize:String(h)},o.value);m.timeRange&&m.timeRange.length===2&&(m.sTime=Math.floor(m.timeRange[0]/1e3),m.eTime=Math.floor(m.timeRange[1]/1e3),delete m.timeRange);try{const j=(yield Ae(m)).data;return{list:j.list||[],page:Number(j.page)||1,pageCount:Number(j.total_page)||0,pageSize:Number(j.page_size)||10,itemCount:Number(j.total)||0}}catch(ye){return s.error("获取用户列表失败"),{list:[],page:1,pageCount:0,pageSize:10,itemCount:0}}})}function C(){n.value.reload()}function A(r){e.value=r,w.value=!0}function x(r){e.value=r,v.value=!0}function O(r){e.value=r,D.value=!0}function k(r){e.value=r,R.value=!0}function _(r){e.value=r,B.value=!0}function M(r){e.value=r,V.value=!0}function ce(r){e.value=r,q.value=!0}function me(r){e.value=r,i.value=!0}function fe(r){var h;$.value=r.id,(h=y.value)==null||h.open()}function E(){C()}function _e(r){o.value=r,C()}function ve(){o.value={},C()}return(r,h)=>{const he=se;return T(),I(he,{bordered:!1,class:"proCard"},{default:a(()=>[l(c(Ie),{onRegister:c(t),onSubmit:_e,onReset:ve},null,8,["onRegister"]),l(c(xe),{columns:c(U),request:g,"row-key":m=>m.id,ref_key:"actionRef",ref:n,actionColumn:u,"scroll-x":2200,striped:!0},null,8,["columns","row-key","actionColumn"]),l(Ve,{visible:w.value,"onUpdate:visible":h[0]||(h[0]=m=>w.value=m),"user-data":e.value,onSuccess:E},null,8,["visible","user-data"]),l(qe,{visible:v.value,"onUpdate:visible":h[1]||(h[1]=m=>v.value=m),"user-data":e.value,onSuccess:E},null,8,["visible","user-data"]),l(Oe,{visible:D.value,"onUpdate:visible":h[2]||(h[2]=m=>D.value=m),"user-data":e.value,onSuccess:E},null,8,["visible","user-data"]),l(Ee,{visible:R.value,"onUpdate:visible":h[3]||(h[3]=m=>R.value=m),"user-data":e.value},null,8,["visible","user-data"]),l(Fe,{visible:B.value,"onUpdate:visible":h[4]||(h[4]=m=>B.value=m),"user-data":e.value,onSuccess:E},null,8,["visible","user-data"]),l(Le,{visible:V.value,"onUpdate:visible":h[5]||(h[5]=m=>V.value=m),"user-data":e.value,onSuccess:E},null,8,["visible","user-data"]),l(je,{visible:q.value,"onUpdate:visible":h[6]||(h[6]=m=>q.value=m),"user-data":e.value,onSuccess:E},null,8,["visible","user-data"]),l(Ge,{visible:i.value,"onUpdate:visible":h[7]||(h[7]=m=>i.value=m),"user-data":e.value,onSuccess:E},null,8,["visible","user-data"]),l(ft,{ref_key:"dispatchOrderRef",ref:y,uid:$.value},null,8,["uid"])]),_:1})}}});export{Vt as default};
