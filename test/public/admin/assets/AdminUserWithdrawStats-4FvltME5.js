var N=Object.defineProperty;var P=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var B=(l,n,e)=>n in l?N(l,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[n]=e,b=(l,n)=>{for(var e in n||(n={}))W.call(n,e)&&B(l,e,n[e]);if(P)for(var e of P(n))j.call(n,e)&&B(l,e,n[e]);return l};var z=(l,n,e)=>new Promise((r,c)=>{var h=u=>{try{v(e.next(u))}catch(y){c(y)}},s=u=>{try{v(e.throw(u))}catch(y){c(y)}},v=u=>u.done?r(u.value):Promise.resolve(u.value).then(h,s);v((e=e.apply(l,n)).next())});import{_ as A}from"./FilterBar.vue_vue_type_script_setup_true_lang-gfuIPf8k.js";import{_ as q}from"./ViewSwitch.vue_vue_type_script_setup_true_lang-BVFIkSef.js";import{d as E,e as T}from"./statistics-Cim6qAMZ.js";import{d as G,u as H,r as g,t as J,o as D,x as K,w as p,j as o,a as m,y as x,c as F,s as $,v as U,B as L,D as O,$ as Q,q as R,n as X}from"./index-C4bwFPRU.js";import"./admin-Bh8KwK6n.js";import"./ButtonGroup-BJvOPcgS.js";const Y={class:"summary-item"},Z={class:"summary-value"},aa={class:"summary-item"},ta={class:"summary-value"},ea={class:"summary-item"},na={class:"summary-value"},sa={key:0},ia={key:1},oa=G({__name:"AdminUserWithdrawStats",setup(l){const n=H(),e=g("summary"),r=g(!1),c=g({start_date:void 0,end_date:void 0,admin_username:void 0}),h={0:{label:"待审核",type:"info"},1:{label:"审核通过",type:"success"},2:{label:"审核拒绝",type:"error"}},s=g({total_withdraw_count:0,total_withdraw_amount:0,day_average_amount:0,status_stats:[],day_stats:[],day_details:[]}),v=[{title:"提现状态",key:"status",width:150,render(t){const a=h[t.status];return $(U,{type:a.type,bordered:!1},{default:()=>a.label})}},{title:"提现笔数",key:"withdraw_count",width:150},{title:"提现金额",key:"withdraw_amount",width:200,render(t){return`¥${w(t.withdraw_amount)}`}},{title:"占比",key:"percentage",width:150,render(t){return`${t.percentage.toFixed(2)}%`}}],u=[{title:"日期",key:"date",width:150},{title:"提现笔数",key:"withdraw_count",width:150},{title:"提现金额",key:"withdraw_amount",width:200,render(t){return`¥${w(t.withdraw_amount)}`}},{title:"占总提现比例",key:"percentage",width:150,render(t){return`${t.percentage.toFixed(2)}%`}},{title:"操作",key:"action",width:150,render(t){return $(L,{text:!0,type:"primary",size:"small",onClick:()=>I(t)},{default:()=>"查看明细"})}}],y=[{title:"ID",key:"id",width:80},{title:"日期",key:"date",width:150},{title:"提现状态",key:"status",width:120,render(t){const a=h[t.status];return $(U,{type:a.type,bordered:!1},{default:()=>a.label})}},{title:"提现笔数",key:"withdraw_count",width:120},{title:"提现金额",key:"withdraw_amount",width:180,render(t){return`¥${w(t.withdraw_amount)}`}}],_=g({page:1,pageSize:10,pageCount:1,itemCount:0,showSizePicker:!1,onChange:void 0}),i=g({page:1,pageSize:10,pageCount:1,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50],onChange:void 0,onUpdatePageSize:void 0});function w(t){return new Intl.NumberFormat("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function C(){return z(this,null,function*(){try{r.value=!0;const t=b({limit:String(_.value.pageSize),page:String(_.value.page),view_type:"summary"},c.value),a=yield E(t);a.code===1&&a.data?(s.value.total_withdraw_count=a.data.total_withdraw_count||0,s.value.total_withdraw_amount=a.data.total_withdraw_amount||0,s.value.day_average_amount=a.data.day_average_amount||0,s.value.status_stats=a.data.status_stats||[],s.value.day_stats=a.data.day_stats||[],s.value.day_details=a.data.day_details||[],a.data.pagination&&(_.value.page=a.data.pagination.page,_.value.pageCount=a.data.pagination.pageCount,_.value.itemCount=a.data.pagination.itemCount,_.value.onChange=d=>{_.value.page=d,C()})):n.error(a.message||"加载数据失败")}catch(t){console.error("加载数据失败:",t),n.error("加载数据失败")}finally{r.value=!1}})}function f(){return z(this,null,function*(){try{r.value=!0;const t=b({limit:String(i.value.pageSize),page:String(i.value.page),view_type:"detail"},c.value),a=yield T(t);a.code===1&&a.data?(s.value.day_details=a.data.day_details||[],a.data.pagination&&(i.value.page=a.data.pagination.page,i.value.pageCount=a.data.pagination.pageCount,i.value.itemCount=a.data.pagination.itemCount,i.value.onChange=d=>{i.value.page=d,f()},i.value.onUpdatePageSize=d=>{i.value.pageSize=d,i.value.page=1,f()})):n.error(a.message||"加载明细数据失败")}catch(t){console.error("加载明细数据失败:",t),n.error("加载明细数据失败")}finally{r.value=!1}})}function V(t){console.log("筛选条件:",t),c.value={start_date:t.startDate,end_date:t.endDate,admin_username:t.adminUsername},e.value==="summary"?(_.value.page=1,C()):(i.value.page=1,f())}function I(t){console.log("查看明细:",t),e.value="detail",i.value.page=1,f()}return J(()=>{C()}),(t,a)=>{const d=O,k=Q,S=R;return D(),K(d,{vertical:"",size:"large"},{default:p(()=>[o(d,{justify:"space-between",align:"start"},{default:p(()=>[o(d,{size:"large"},{default:p(()=>[m("div",Y,[a[1]||(a[1]=m("div",{class:"summary-label"},"总提现笔数",-1)),m("div",Z,x(s.value.total_withdraw_count),1)]),m("div",aa,[a[2]||(a[2]=m("div",{class:"summary-label"},"总提现金额",-1)),m("div",ta,"￥"+x(w(s.value.total_withdraw_amount)),1)]),m("div",ea,[a[3]||(a[3]=m("div",{class:"summary-label"},"日均提现金额",-1)),m("div",na,"￥"+x(w(s.value.day_average_amount)),1)])]),_:1}),o(A,{onChange:V})]),_:1}),o(d,null,{default:p(()=>[o(q,{modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=M=>e.value=M)},null,8,["modelValue"])]),_:1}),e.value==="summary"?(D(),F("div",sa,[o(S,{bordered:!1,title:"提现状态统计",class:"mb-4"},{default:p(()=>[o(k,{columns:v,data:s.value.status_stats,pagination:!1,bordered:!1,loading:r.value},null,8,["data","loading"])]),_:1}),o(S,{bordered:!1,title:"按日统计"},{default:p(()=>[o(k,{columns:u,data:s.value.day_stats,pagination:_.value,bordered:!1,loading:r.value},null,8,["data","pagination","loading"])]),_:1})])):(D(),F("div",ia,[o(S,{bordered:!1,title:"明细统计"},{default:p(()=>[o(k,{columns:y,data:s.value.day_details,pagination:i.value,bordered:!1,loading:r.value},null,8,["data","pagination","loading"])]),_:1})]))]),_:1})}}}),ca=X(oa,[["__scopeId","data-v-81233fd4"]]);export{ca as default};
