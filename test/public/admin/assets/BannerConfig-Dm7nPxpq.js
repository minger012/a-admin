var Y=Object.defineProperty,Z=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var z=(n,l,a)=>l in n?Y(n,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[l]=a,k=(n,l)=>{for(var a in l||(l={}))H.call(l,a)&&z(n,a,l[a]);if(R)for(var a of R(l))J.call(l,a)&&z(n,a,l[a]);return n},C=(n,l)=>Z(n,G(l));var I=(n,l,a)=>new Promise((o,g)=>{var w=s=>{try{v(a.next(s))}catch(p){g(p)}},u=s=>{try{v(a.throw(s))}catch(p){g(p)}},v=s=>s.done?o(s.value):Promise.resolve(s.value).then(w,u);v((a=a.apply(n,l)).next())});import{u as K}from"./file-DWsZIRwZ.js";import{Q as W}from"./vue-quill.snow-DU2ztcMD.js";import{P as ee}from"./PlusOutlined-DRSj6shY.js";import{d as te,u as ae,r as y,b as le,o as N,c as $,a as q,j as i,w as f,X as L,a6 as ne,h as b,N as oe,i as D,B as V,s as d,U as ue,k as E,C as se,Y as re,Z as ie,$ as de,D as ce,E as pe,n as me}from"./index--W9FB2Si.js";const fe={class:"mb-3 flex justify-end"},ge=te({__name:"BannerConfig",props:{modelValue:{}},emits:["update:modelValue"],setup(n,{emit:l}){const a=ae(),o=n,g=l,w=[{label:"日本語",value:"ja-ja"},{label:"english",value:"en-us"},{label:"中文",value:"zh-cn"},{label:"繁體",value:"zh-tw"},{label:"한국어",value:"ko-ko"},{label:"Việt nam",value:"vi-vi"}],u=y("ja-ja"),v=y(null),s=y(!1),p=y(!1),U=y(0),x=y(""),M=y(),O=le({modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{align:[]}],["clean"],["image","link"]]},theme:"snow",placeholder:"请输入内容..."});function _(){g("update:modelValue",k({},o.modelValue))}function F(t){const e=o.modelValue[u.value]||[];U.value=t,x.value=e[t].richContent||"",p.value=!0}function P(t){const e=document.createElement("input");e.type="file",e.accept="image/jpeg,image/png,image/gif",e.onchange=r=>I(this,null,function*(){const h=r.target.files[0];if(h){if(!["image/jpeg","image/png","image/gif"].includes(h.type)){a.error("只能上传jpg/png/gif格式的图片");return}if(h.size>2*1024*1024){a.error("图片大小不能超过2MB");return}try{v.value=t,a.loading("上传中...");const m=yield K(h);if(m.code===1){const B=o.modelValue[u.value]||[];B[t].image=m.data.url,_(),a.success("上传成功")}else a.error(m.msg||"上传失败")}catch(m){console.error("上传错误:",m),a.error("上传失败")}finally{v.value=null}}}),e.click()}const Q=[{title:"排序",key:"sort",width:100,render:t=>d(ue,{value:t.sort,showButton:!1,onUpdateValue:e=>{t.sort=e!=null?e:0,s.value=!0,_()},onBlur:()=>{s.value&&(s.value=!1,setTimeout(()=>{_()},0))},min:0,style:{width:"100%"}})},{title:"背景图片",key:"image",width:200,render:(t,e)=>d("div",{class:"flex items-center gap-2"},[t.image?d("img",{src:t.image,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"4px"}}):d("div",{style:{width:"60px",height:"60px",border:"1px dashed #ccc",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"12px"}},"无图片"),d(V,{size:"small",disabled:v.value!==null,loading:v.value===e,onClick:()=>P(e)},{default:()=>"上传"})])},{title:"标题",key:"title",width:200,render:t=>d(E,{value:t.title,onUpdateValue:e=>{t.title=e,_()},placeholder:"请输入标题"})},{title:"描述",key:"desc",width:200,render:t=>d(E,{value:t.desc,onUpdateValue:e=>{t.desc=e,_()},placeholder:"请输入描述"})},{title:"类型",key:"type",width:150,render:t=>d(se,{value:t.type,onUpdateValue:e=>{t.type=e,_()},options:[{label:"路径",value:1},{label:"链接",value:2},{label:"富文本",value:3}],placeholder:"请选择类型"})},{title:"数据",key:"data",width:200,render:(t,e)=>t.type===3?d(V,{size:"small",onClick:()=>F(e)},{default:()=>"编辑"}):d(E,{value:t.data,onUpdateValue:r=>{t.data=r,_()},placeholder:t.type===1?"/path":"https://..."})},{title:"操作",key:"action",width:100,fixed:"right",render:(t,e)=>d(V,{text:!0,type:"error",onClick:()=>A(e)},{default:()=>"删除"})}];function j(){if(!o.modelValue||typeof o.modelValue!="object")return g("update:modelValue",{}),[];if(!o.modelValue[u.value]){const e=C(k({},o.modelValue),{[u.value]:[]});return g("update:modelValue",e),[]}const t=o.modelValue[u.value]||[];return s.value?t:[...t].sort((e,r)=>(e.sort||0)-(r.sort||0))}function S(){const t=j(),e={sort:t.length+1,image:"",title:"",desc:"",type:1,data:"",richContent:""},r=C(k({},o.modelValue),{[u.value]:[...t,e]});g("update:modelValue",r)}function T(){const t=o.modelValue[u.value]||[];t[U.value].richContent=x.value,_(),p.value=!1,a.success("保存成功")}function A(t){const e=j(),r=C(k({},o.modelValue),{[u.value]:e.filter((h,m)=>m!==t)});g("update:modelValue",r)}return(t,e)=>{const r=re,h=ie,m=de,B=ce,X=pe;return N(),$(L,null,[q("div",null,[i(h,{value:u.value,"onUpdate:value":e[0]||(e[0]=c=>u.value=c),type:"segment",class:"mb-4"},{default:f(()=>[(N(),$(L,null,ne(w,c=>i(r,{key:c.value,name:c.value,tab:c.label},null,8,["name","tab"])),64))]),_:1},8,["value"]),q("div",fe,[i(b(V),{size:"small",onClick:S},{icon:f(()=>[i(b(oe),null,{default:f(()=>[i(b(ee))]),_:1})]),default:f(()=>[e[4]||(e[4]=D(" 添加Banner "))]),_:1})]),i(m,{columns:Q,data:j(),pagination:!1,bordered:!1,"scroll-x":1200},null,8,["data"])]),i(X,{show:p.value,"onUpdate:show":e[3]||(e[3]=c=>p.value=c),preset:"card",title:"编辑富文本内容",style:{width:"900px"}},{footer:f(()=>[i(B,{justify:"end"},{default:f(()=>[i(b(V),{onClick:e[2]||(e[2]=c=>p.value=!1)},{default:f(()=>e[5]||(e[5]=[D("取消")])),_:1}),i(b(V),{type:"primary",onClick:T},{default:f(()=>e[6]||(e[6]=[D("确定")])),_:1})]),_:1})]),default:f(()=>[i(b(W),{ref_key:"quillEditorRef",ref:M,options:O,content:x.value,"onUpdate:content":e[1]||(e[1]=c=>x.value=c),"content-type":"html",style:{height:"400px"}},null,8,["options","content"])]),_:1},8,["show"])],64)}}}),Ve=me(ge,[["__scopeId","data-v-2d7bf8a4"]]);export{Ve as default};
