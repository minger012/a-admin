var w=(d,c,u)=>new Promise((_,p)=>{var r=a=>{try{i(u.next(a))}catch(t){p(t)}},f=a=>{try{i(u.throw(a))}catch(t){p(t)}},i=a=>a.done?_(a.value):Promise.resolve(a.value).then(r,f);i((u=u.apply(d,c)).next())});import{d as q,u as E,r as v,b as N,aa as k,o as S,x as T,w as s,j as n,i as y,dW as V,k as j,l as z,U as O,C as P,_ as W,B as $,D as A,E as F}from"./index-C4bwFPRU.js";const I=q({__name:"DeductModal",props:{visible:{type:Boolean},userData:{}},emits:["update:visible","success"],setup(d,{emit:c}){const u=E(),_=v(),p=v(!1),r=v(!1),f=[{label:"真实扣款",value:1},{label:"虚拟扣款",value:2},{label:"系统扣款",value:3}],i=d,a=c,t=N({id:0,money:0,type:1,user_remarks:""}),h={money:{required:!0,type:"number",message:"请输入扣款金额",trigger:["blur","change"],validator:(o,e)=>!e||e<=0?new Error("扣款金额必须大于0"):!0},type:{required:!0,type:"number",message:"请选择扣款类型",trigger:["change"]},user_remarks:{required:!0,message:"请输入用户端备注",trigger:["blur","input"]}};k(()=>i.visible,o=>{r.value=o,o&&i.userData&&(t.id=i.userData.id,t.money=0,t.type=1,t.user_remarks="")}),k(r,o=>{a("update:visible",o)});const x=()=>{r.value=!1},C=()=>w(this,null,function*(){var o;try{yield(o=_.value)==null?void 0:o.validate(),p.value=!0;const e=yield V(t);e.code===1?(u.success("扣款成功"),r.value=!1,a("success")):u.error(e.msg||"扣款失败")}catch(e){console.error("表单提交错误:",e)}finally{p.value=!1}});return(o,e)=>{const g=j,m=z,D=O,B=P,U=W,b=$,M=A,R=F;return S(),T(R,{show:r.value,"onUpdate:show":e[3]||(e[3]=l=>r.value=l),"show-icon":!1,preset:"dialog",title:"用户扣款",style:{width:"500px"}},{action:s(()=>[n(M,null,{default:s(()=>[n(b,{onClick:x},{default:s(()=>e[5]||(e[5]=[y("取消")])),_:1}),n(b,{type:"error",loading:p.value,onClick:C},{default:s(()=>e[6]||(e[6]=[y("确定扣款")])),_:1},8,["loading"])]),_:1})]),default:s(()=>[n(U,{model:t,rules:h,ref_key:"formRef",ref:_,"label-placement":"left","label-width":100,class:"py-4"},{default:s(()=>[n(m,{label:"用户名"},{default:s(()=>{var l;return[n(g,{value:(l=o.userData)==null?void 0:l.username,disabled:""},null,8,["value"])]}),_:1}),n(m,{label:"扣款金额",path:"money"},{default:s(()=>[n(D,{value:t.money,"onUpdate:value":e[0]||(e[0]=l=>t.money=l),min:0,precision:2,placeholder:"请输入扣款金额",style:{width:"100%"}},{prefix:s(()=>e[4]||(e[4]=[y("¥")])),_:1},8,["value"])]),_:1}),n(m,{label:"扣款类型",path:"type"},{default:s(()=>[n(B,{value:t.type,"onUpdate:value":e[1]||(e[1]=l=>t.type=l),options:f,placeholder:"请选择扣款类型"},null,8,["value"])]),_:1}),n(m,{label:"用户端备注",path:"user_remarks"},{default:s(()=>[n(g,{type:"textarea",placeholder:"请输入用户端备注",value:t.user_remarks,"onUpdate:value":e[2]||(e[2]=l=>t.user_remarks=l),autosize:{minRows:2,maxRows:4}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])}}});export{I as _};
