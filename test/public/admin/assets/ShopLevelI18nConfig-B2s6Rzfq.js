var S=Object.defineProperty,$=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var B=(n,l,a)=>l in n?S(n,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[l]=a,h=(n,l)=>{for(var a in l||(l={}))F.call(l,a)&&B(n,a,l[a]);if(I)for(var a of I(l))M.call(l,a)&&B(n,a,l[a]);return n},V=(n,l)=>$(n,E(l));var D=(n,l,a)=>new Promise((u,c)=>{var y=o=>{try{p(a.next(o))}catch(v){c(v)}},s=o=>{try{p(a.throw(o))}catch(v){c(v)}},p=o=>o.done?u(o.value):Promise.resolve(o.value).then(y,s);p((a=a.apply(n,l)).next())});import{u as O}from"./file-DWsZIRwZ.js";import{P}from"./PlusOutlined-DRSj6shY.js";import{d as T,u as A,r as k,o as U,c as z,j as _,w as b,X,a6 as Y,a as Z,h as w,N as q,i as G,B as j,s as d,k as C,U as H,Y as J,Z as K,$ as Q,n as W}from"./index--W9FB2Si.js";const ee={class:"mb-3 flex justify-end"},te=T({__name:"ShopLevelI18nConfig",props:{modelValue:{}},emits:["update:modelValue"],setup(n,{emit:l}){const a=A(),u=n,c=l,y=[{label:"日本語",value:"ja-ja"},{label:"english",value:"en-us"},{label:"中文",value:"zh-cn"},{label:"繁體",value:"zh-tw"},{label:"한국어",value:"ko-ko"},{label:"Việt nam",value:"vi-vi"}],s=k("ja-ja"),p=k(null),o=k(!1),v=[{title:"星级",key:"level",width:100,render:t=>d(C,{value:t.level,onUpdateValue:e=>{t.level=e,g()},placeholder:"星级1"})},{title:"名称",key:"name",width:150,render:t=>d(C,{value:t.name,onUpdateValue:e=>{t.name=e,g()},placeholder:"请输入名称"})},{title:"描述",key:"desc",width:200,render:t=>d(C,{value:t.desc,onUpdateValue:e=>{t.desc=e,g()},placeholder:"请输入描述"})},{title:"图标",key:"icon",width:200,render:(t,e)=>d("div",{class:"flex items-center gap-2"},[t.icon?d("img",{src:t.icon,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"4px"}}):d("div",{style:{width:"60px",height:"60px",border:"1px dashed #ccc",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"12px"}},"无图标"),d(j,{size:"small",disabled:p.value!==null,loading:p.value===e,onClick:()=>L(e)},{default:()=>"上传"})])},{title:"排序",key:"sort",width:100,render:t=>d(H,{value:t.sort,showButton:!1,onUpdateValue:e=>{t.sort=e!=null?e:0,o.value=!0,g()},onBlur:()=>{o.value&&(o.value=!1,setTimeout(()=>{g()},0))},min:0,style:{width:"100%"}})},{title:"操作",key:"action",width:100,fixed:"right",render:(t,e)=>d(j,{text:!0,type:"error",onClick:()=>R(e)},{default:()=>"删除"})}];function x(){if(!u.modelValue||typeof u.modelValue!="object")return c("update:modelValue",{}),[];if(!u.modelValue[s.value]){const e=V(h({},u.modelValue),{[s.value]:[]});return c("update:modelValue",e),[]}const t=u.modelValue[s.value]||[];return o.value?t:[...t].sort((e,r)=>(e.sort||0)-(r.sort||0))}function g(){c("update:modelValue",h({},u.modelValue))}function L(t){const e=document.createElement("input");e.type="file",e.accept="image/jpeg,image/png,image/gif",e.onchange=r=>D(this,null,function*(){const m=r.target.files[0];if(m){if(!["image/jpeg","image/png","image/gif"].includes(m.type)){a.error("只能上传jpg/png/gif格式的图片");return}if(m.size>2*1024*1024){a.error("图片大小不能超过2MB");return}try{p.value=t,a.loading("上传中...");const i=yield O(m);if(i.code===1){const f=u.modelValue[s.value]||[];f[t].icon=i.data.url,g(),a.success("上传成功")}else a.error(i.msg||"上传失败")}catch(i){console.error("上传错误:",i),a.error("上传失败")}finally{p.value=null}}}),e.click()}function N(){const t=x(),e={level:`星级${t.length+1}`,name:"",desc:"",icon:"",sort:t.length+1},r=V(h({},u.modelValue),{[s.value]:[...t,e]});c("update:modelValue",r)}function R(t){const e=x(),r=V(h({},u.modelValue),{[s.value]:e.filter((m,i)=>i!==t)});c("update:modelValue",r)}return(t,e)=>{const r=J,m=K,i=Q;return U(),z("div",null,[_(m,{value:s.value,"onUpdate:value":e[0]||(e[0]=f=>s.value=f),type:"segment",class:"mb-4"},{default:b(()=>[(U(),z(X,null,Y(y,f=>_(r,{key:f.value,name:f.value,tab:f.label},null,8,["name","tab"])),64))]),_:1},8,["value"]),Z("div",ee,[_(w(j),{size:"small",onClick:N},{icon:b(()=>[_(w(q),null,{default:b(()=>[_(w(P))]),_:1})]),default:b(()=>[e[1]||(e[1]=G(" 添加阶梯 "))]),_:1})]),_(i,{columns:v,data:x(),pagination:!1,bordered:!1},null,8,["data"])])}}}),ue=W(te,[["__scopeId","data-v-7dfe3230"]]);export{ue as default};
