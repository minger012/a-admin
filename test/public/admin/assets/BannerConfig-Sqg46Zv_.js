var R=Object.defineProperty,A=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var D=(o,n,a)=>n in o?R(o,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[n]=a,v=(o,n)=>{for(var a in n||(n={}))O.call(n,a)&&D(o,a,n[a]);if(C)for(var a of C(n))T.call(n,a)&&D(o,a,n[a]);return o},V=(o,n)=>A(o,F(n));var U=(o,n,a)=>new Promise((k,u)=>{var r=l=>{try{_(a.next(l))}catch(h){u(h)}},d=l=>{try{_(a.throw(l))}catch(h){u(h)}},_=l=>l.done?k(l.value):Promise.resolve(l.value).then(r,d);_((a=a.apply(o,n)).next())});import{d as S,a7 as M,a8 as $,u as G,r as H,o as I,c as z,j as f,w as b,a1 as X,aH as Y,a as Z,h as j,N as q,i as J,B,s,U as K,k as x,Y as Q,Z as W,$ as ee,n as te}from"./index-FB6W5mBG.js";import{P as ae}from"./PlusOutlined-BWpPOq4g.js";const ne={class:"mb-3 flex justify-end"},le=S({__name:"BannerConfig",props:{modelValue:{}},emits:["update:modelValue"],setup(o,{emit:n}){const{VITE_GLOB_API_URL_PREFIX:a}=M(),k=$(),u=G(),r=o,d=n,_=[{label:"日本語",value:"ja-ja"},{label:"english",value:"en-us"},{label:"中文",value:"zh-cn"},{label:"繁體",value:"zh-tw"},{label:"한국어",value:"ko-ko"},{label:"Việt nam",value:"vi-vi"}],l=H("ja-ja"),h=[{title:"排序",key:"sort",width:100,render:t=>s(K,{value:t.sort,onUpdateValue:e=>{t.sort=e!=null?e:0,m()},min:0,style:{width:"100%"}})},{title:"背景图片",key:"image",width:200,render:(t,e)=>s("div",{class:"flex items-center gap-2"},[t.image?s("img",{src:t.image,style:{width:"60px",height:"60px",objectFit:"cover",borderRadius:"4px"}}):s("div",{style:{width:"60px",height:"60px",border:"1px dashed #ccc",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"12px"}},"无图片"),s(B,{size:"small",onClick:()=>N(e)},{default:()=>"上传"})])},{title:"标题",key:"title",width:200,render:t=>s(x,{value:t.title,onUpdateValue:e=>{t.title=e,m()},placeholder:"请输入标题"})},{title:"描述",key:"desc",width:200,render:t=>s(x,{value:t.desc,onUpdateValue:e=>{t.desc=e,m()},placeholder:"请输入描述"})},{title:"类型",key:"type",width:150,render:t=>s(x,{value:t.type,onUpdateValue:e=>{t.type=e,m()},placeholder:"路径"})},{title:"数据",key:"data",width:200,render:t=>s(x,{value:t.data,onUpdateValue:e=>{t.data=e,m()},placeholder:"/path"})},{title:"操作",key:"action",width:100,fixed:"right",render:(t,e)=>s(B,{text:!0,type:"error",onClick:()=>L(e)},{default:()=>"删除"})}];function y(){if(!r.modelValue||typeof r.modelValue!="object")return d("update:modelValue",{}),[];if(!r.modelValue[l.value]){const t=V(v({},r.modelValue),{[l.value]:[]});return d("update:modelValue",t),[]}return r.modelValue[l.value]||[]}function m(){d("update:modelValue",v({},r.modelValue))}function E(){const t=y(),e={sort:t.length+1,image:"",title:"",desc:"",type:"路径",data:""},c=V(v({},r.modelValue),{[l.value]:[...t,e]});d("update:modelValue",c)}function L(t){const e=y(),c=V(v({},r.modelValue),{[l.value]:e.filter((p,g)=>g!==t)});d("update:modelValue",c)}function N(t){const e=document.createElement("input");e.type="file",e.accept="image/jpeg,image/png,image/gif",e.onchange=c=>U(this,null,function*(){const p=c.target.files[0];if(!p)return;if(!["image/jpeg","image/png","image/gif"].includes(p.type)){u.error("只能上传jpg/png/gif格式的图片");return}if(p.size>2*1024*1024){u.error("图片大小不能超过2MB");return}const g=new FormData;g.append("image",p);try{u.loading("上传中...");const w=yield(yield fetch(a+"/admin/file/uploadImage",{method:"POST",headers:{Authorization:k.getToken},body:g})).json();if(w.code===1){const P=y();P[t].image=w.data.url,m(),u.success("上传成功")}else u.error(w.msg||"上传失败")}catch(i){console.error("上传错误:",i),u.error("上传失败")}}),e.click()}return(t,e)=>{const c=Q,p=W,g=ee;return I(),z("div",null,[f(p,{value:l.value,"onUpdate:value":e[0]||(e[0]=i=>l.value=i),type:"segment",class:"mb-4"},{default:b(()=>[(I(),z(X,null,Y(_,i=>f(c,{key:i.value,name:i.value,tab:i.label},null,8,["name","tab"])),64))]),_:1},8,["value"]),Z("div",ne,[f(j(B),{size:"small",onClick:E},{icon:b(()=>[f(j(q),null,{default:b(()=>[f(j(ae))]),_:1})]),default:b(()=>[e[1]||(e[1]=J(" 添加Banner "))]),_:1})]),f(g,{columns:h,data:y(),pagination:!1,bordered:!1,"scroll-x":1200},null,8,["data"])])}}}),ue=te(le,[["__scopeId","data-v-1d1c1be9"]]);export{ue as default};
