var x=(k,u,s)=>new Promise((r,i)=>{var c=l=>{try{n(s.next(l))}catch(p){i(p)}},m=l=>{try{n(s.throw(l))}catch(p){i(p)}},n=l=>l.done?r(l.value):Promise.resolve(l.value).then(c,m);n((s=s.apply(k,u)).next())});import{g as T,E as $,e as B}from"./statistics-D7Rvz2Jm.js";import{S as D}from"./SearchOutlined-ChmzzWoz.js";import{d as M,u as N,r as d,b as U,t as K,c as O,j as a,w as o,q as P,o as V,h as C,i as g,y as j,W as q,l as I,N as W,B as A,D as F,_ as G,$ as H}from"./index-BEDOAs2M.js";import"./xlsx-DaVhO591.js";const Z=M({__name:"index",setup(k){const u=N(),s=d(null),r=d([]),i=d(!1),c=d([]),m=[{type:"selection"},{title:"日期",key:"date",width:150},{title:"注册人数",key:"register_count",width:150},{title:"创建时间",key:"create_time",width:200}],n=U({page:1,pageSize:20,pageCount:1,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50],onChange:e=>{n.page=e,l()},onUpdatePageSize:e=>{n.pageSize=e,n.page=1,l()}});function l(){return x(this,null,function*(){try{i.value=!0;const e={page:n.page,pageSize:n.pageSize};s.value&&s.value.length===2&&(e.sTime=Math.floor(s.value[0]/1e3),e.eTime=Math.floor(s.value[1]/1e3));const t=yield T(e);t.code===1&&t.data?(c.value=t.data.list||[],n.itemCount=t.data.total||0,n.pageCount=t.data.total_page||1):u.error(t.msg||"获取数据失败")}catch(e){console.error("加载数据失败:",e),u.error("加载数据失败，请重试")}finally{i.value=!1}})}function p(){n.page=1,l()}function S(){s.value=null,n.page=1,l()}function b(){try{let e=c.value;if(r.value.length>0?(e=c.value.filter(f=>r.value.includes(f.date)),console.log(`导出选中的 ${e.length} 条数据`)):console.log("导出全部数据"),e.length===0){u.warning("没有可导出的数据");return}B(e,[{title:"日期",key:"date"},{title:"注册人数",key:"register_count"},{title:"创建时间",key:"create_time"}],"注册统计"),u.success(`已导出 ${e.length} 条数据`),r.value=[]}catch(e){console.error("导出失败:",e),u.error("导出失败，请重试")}}return K(()=>{l()}),(e,t)=>{const f=q,h=I,w=W,v=A,y=F,z=G,E=H,R=P;return V(),O("div",null,[a(R,{bordered:!1,class:"proCard",title:"注册统计"},{default:o(()=>[a(y,{vertical:"",size:"large"},{default:o(()=>[a(z,{inline:"","label-placement":"left"},{default:o(()=>[a(h,{label:"创建时间"},{default:o(()=>[a(f,{value:s.value,"onUpdate:value":t[0]||(t[0]=_=>s.value=_),type:"daterange",clearable:"",style:{width:"400px"}},null,8,["value"])]),_:1}),a(h,null,{default:o(()=>[a(y,null,{default:o(()=>[a(v,{type:"primary",onClick:p},{icon:o(()=>[a(w,null,{default:o(()=>[a(C(D))]),_:1})]),default:o(()=>[t[2]||(t[2]=g(" 查询 "))]),_:1}),a(v,{onClick:S},{default:o(()=>t[3]||(t[3]=[g("重置")])),_:1})]),_:1})]),_:1})]),_:1}),a(y,null,{default:o(()=>[a(v,{onClick:b},{icon:o(()=>[a(w,null,{default:o(()=>[a(C($))]),_:1})]),default:o(()=>[t[4]||(t[4]=g(" 导出 "))]),_:1}),g(" "+j(r.value.length>0?`(已选${r.value.length}项)`:""),1)]),_:1}),a(E,{columns:m,data:c.value,pagination:n,loading:i.value,bordered:!1,"row-key":_=>_.date,"checked-row-keys":r.value,"onUpdate:checkedRowKeys":t[1]||(t[1]=_=>r.value=_)},null,8,["data","pagination","loading","row-key","checked-row-keys"])]),_:1})]),_:1})])}}});export{Z as default};
