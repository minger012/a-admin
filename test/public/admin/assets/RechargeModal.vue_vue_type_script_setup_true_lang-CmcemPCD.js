var b=(d,c,u)=>new Promise((_,p)=>{var r=l=>{try{i(u.next(l))}catch(a){p(a)}},f=l=>{try{i(u.throw(l))}catch(a){p(a)}},i=l=>l.done?_(l.value):Promise.resolve(l.value).then(r,f);i((u=u.apply(d,c)).next())});import{d as M,u as V,r as v,b as z,aa as k,o as E,x as N,w as n,j as s,i as w,dV as T,k as j,l as O,U as P,C as S,_ as $,B as A,D as F,E as G}from"./index-BEDOAs2M.js";const J=M({__name:"RechargeModal",props:{visible:{type:Boolean},userData:{}},emits:["update:visible","success"],setup(d,{emit:c}){const u=V(),_=v(),p=v(!1),r=v(!1),f=[{label:"真实充值",value:1},{label:"虚拟充值",value:2},{label:"系统赠送",value:3}],i=d,l=c,a=z({id:0,money:0,type:1,remarks:"",user_remarks:""}),h={money:{required:!0,type:"number",message:"请输入充值金额",trigger:["blur","change"],validator:(o,e)=>!e||e<=0?new Error("充值金额必须大于0"):!0},type:{required:!0,type:"number",message:"请选择充值类型",trigger:["change"]},remarks:{required:!0,message:"请输入备注",trigger:["blur","input"]},user_remarks:{required:!0,message:"请输入用户端备注",trigger:["blur","input"]}};k(()=>i.visible,o=>{r.value=o,o&&i.userData&&(a.id=i.userData.id,a.money=0,a.type=1,a.remarks="",a.user_remarks="")}),k(r,o=>{l("update:visible",o)});const x=()=>{r.value=!1},R=()=>b(this,null,function*(){var o;try{yield(o=_.value)==null?void 0:o.validate(),p.value=!0;const e=yield T(a);e.code===1?(u.success("充值成功"),r.value=!1,l("success")):u.error(e.msg||"充值失败")}catch(e){console.error("表单提交错误:",e)}finally{p.value=!1}});return(o,e)=>{const g=j,m=O,C=P,U=S,B=$,y=A,D=F,q=G;return E(),N(q,{show:r.value,"onUpdate:show":e[4]||(e[4]=t=>r.value=t),"show-icon":!1,preset:"dialog",title:"用户充值",style:{width:"500px"}},{action:n(()=>[s(D,null,{default:n(()=>[s(y,{onClick:x},{default:n(()=>e[5]||(e[5]=[w("取消")])),_:1}),s(y,{type:"primary",loading:p.value,onClick:R},{default:n(()=>e[6]||(e[6]=[w("确定")])),_:1},8,["loading"])]),_:1})]),default:n(()=>[s(B,{model:a,rules:h,ref_key:"formRef",ref:_,"label-placement":"left","label-width":100,class:"py-4"},{default:n(()=>[s(m,{label:"用户名"},{default:n(()=>{var t;return[s(g,{value:(t=o.userData)==null?void 0:t.username,disabled:""},null,8,["value"])]}),_:1}),s(m,{label:"充值金额",path:"money"},{default:n(()=>[s(C,{value:a.money,"onUpdate:value":e[0]||(e[0]=t=>a.money=t),min:0,precision:2,placeholder:"请输入充值金额",style:{width:"100%"}},null,8,["value"])]),_:1}),s(m,{label:"充值类型",path:"type"},{default:n(()=>[s(U,{value:a.type,"onUpdate:value":e[1]||(e[1]=t=>a.type=t),options:f,placeholder:"请选择充值类型"},null,8,["value"])]),_:1}),s(m,{label:"备注",path:"remarks"},{default:n(()=>[s(g,{type:"textarea",placeholder:"请输入备注",value:a.remarks,"onUpdate:value":e[2]||(e[2]=t=>a.remarks=t),autosize:{minRows:2,maxRows:4}},null,8,["value"])]),_:1}),s(m,{label:"用户端备注",path:"user_remarks"},{default:n(()=>[s(g,{type:"textarea",placeholder:"请输入用户端备注",value:a.user_remarks,"onUpdate:value":e[3]||(e[3]=t=>a.user_remarks=t),autosize:{minRows:2,maxRows:4}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])}}});export{J as _};
