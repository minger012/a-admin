var w=(M,v,i)=>new Promise((f,c)=>{var h=n=>{try{u(i.next(n))}catch(g){c(g)}},m=n=>{try{u(i.throw(n))}catch(g){c(g)}},u=n=>n.done?f(n.value):Promise.resolve(n.value).then(h,m);u((i=i.apply(M,v)).next())});import{g as S}from"./admin-3ONY92Rh.js";import{d as x,r as _,t as A,o as D,x as T,w as b,a as Y,j as y,c as N,a6 as O,i as V,y as $,X as z,z as L,C as U,B as j,W as E,D as H}from"./index-BEDOAs2M.js";import{_ as Q}from"./ButtonGroup-B1x3NxWM.js";const G=x({__name:"FilterBar",emits:["change"],setup(M,{emit:v}){const i=v,f=[{label:"今日",value:"今日"},{label:"本周",value:"本周"},{label:"本月",value:"本月"},{label:"本年",value:"本年"},{label:"自定义",value:"自定义"}],c=_([{label:"所有",value:null}]);function h(){return w(this,null,function*(){try{const t=yield S({page:"1",pageSize:"1000"});if(t.code===1&&t.data&&t.data.list){const a=t.data.list.map(l=>({label:`${l.username}${l.name?` (${l.name})`:""}`,value:l.id,username:l.username}));c.value=[{label:"所有",value:null,username:null},...a]}}catch(t){console.error("加载管理员列表失败:",t)}})}const m=_(null),u=_("本月"),n=_(null);function g(){d()}function C(t){u.value=t,t!=="自定义"&&(n.value=null,d())}function B(t){t&&d()}function d(){const t={timeType:u.value};if(m.value){const e=c.value.find(o=>o.value===m.value);e&&e.username&&(t.adminUsername=e.username)}let a,l;if(n.value&&n.value.length===2){const e=new Date(n.value[0]);e.setHours(0,0,0,0),a=Math.floor(e.getTime()/1e3);const o=new Date(n.value[1]);o.setHours(23,59,59,999),l=Math.floor(o.getTime()/1e3)}else{const e=new Date,o=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);switch(u.value){case"今日":a=Math.floor(o.getTime()/1e3),l=Math.floor(r.getTime()/1e3);break;case"本周":const p=new Date(o);p.setDate(o.getDate()-o.getDay()),a=Math.floor(p.getTime()/1e3),l=Math.floor(r.getTime()/1e3);break;case"本月":const s=new Date(e.getFullYear(),e.getMonth(),1);a=Math.floor(s.getTime()/1e3),l=Math.floor(r.getTime()/1e3);break;case"本年":const k=new Date(e.getFullYear(),0,1);a=Math.floor(k.getTime()/1e3),l=Math.floor(r.getTime()/1e3);break;default:const F=new Date(e.getFullYear(),e.getMonth(),1);a=Math.floor(F.getTime()/1e3),l=Math.floor(r.getTime()/1e3)}}t.startDate=a,t.endDate=l,i("change",t)}return A(()=>{h(),d()}),(t,a)=>{const l=U,e=j,o=Q,r=E,p=H;return D(),T(p,{align:"center",size:"medium"},{default:b(()=>[a[2]||(a[2]=Y("span",{style:{color:"#666"}},"选择管理员",-1)),y(l,{value:m.value,"onUpdate:value":[a[0]||(a[0]=s=>m.value=s),g],options:c.value,placeholder:"所有",style:{width:"200px"},clearable:""},null,8,["value","options"]),y(o,null,{default:b(()=>[(D(),N(z,null,O(f,s=>y(e,{key:s.value,type:u.value===s.value?"primary":"default",onClick:k=>C(s.value)},{default:b(()=>[V($(s.label),1)]),_:2},1032,["type","onClick"])),64))]),_:1}),u.value==="自定义"?(D(),T(r,{key:0,value:n.value,"onUpdate:value":[a[1]||(a[1]=s=>n.value=s),B],type:"daterange",clearable:""},null,8,["value"])):L("",!0)]),_:1})}}});export{G as _};
