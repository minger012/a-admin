var H=Object.defineProperty;var F=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var I=(c,u,o)=>u in c?H(c,u,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[u]=o,N=(c,u)=>{for(var o in u||(u={}))L.call(u,o)&&I(c,o,u[o]);if(F)for(var o of F(u))Q.call(u,o)&&I(c,o,u[o]);return c};var U=(c,u,o)=>new Promise((v,m)=>{var b=l=>{try{w(o.next(l))}catch(d){m(d)}},k=l=>{try{w(o.throw(l))}catch(d){m(d)}},w=l=>l.done?v(l.value):Promise.resolve(l.value).then(b,k);w((o=o.apply(c,u)).next())});import X from"./RankingList-BNubLpTU.js";import{h as A}from"./statistics-Cim6qAMZ.js";import{S as G}from"./SearchOutlined-xLFF1osG.js";import{d as J,u as K,r as h,t as Z,o as C,x as B,w as s,j as n,a as g,y as S,c as ee,a6 as te,i as M,X as ae,z as ne,h as le,s as oe,v as se,D as ue,B as ie,W as re,k as de,l as _e,C as ce,N as me,_ as pe,q as ge,$ as ve,n as fe}from"./index-C4bwFPRU.js";import{_ as he}from"./ButtonGroup-BJvOPcgS.js";const we={class:"summary-item"},ye={class:"summary-value"},be={class:"summary-item"},ke={class:"summary-value"},De={class:"ranking-box"},Ce=J({__name:"UserWithdrawStats",setup(c){const u=K(),o=h(!1),v=h("本年"),m=h(null),b=[{label:"今日",value:"今日"},{label:"本周",value:"本周"},{label:"本月",value:"本月"},{label:"本年",value:"本年"},{label:"自定义",value:"自定义"}],k={0:{label:"待审核",type:"info"},1:{label:"成功",type:"success"},2:{label:"驳回",type:"error"}},w=[{label:"待审核",value:0},{label:"成功",value:1},{label:"驳回",value:2}],l=h({user_id:"",nickname:"",status:null}),d=h({total_withdraw_count:0,total_withdraw_amount:0,top_users:[],detail_list:[]}),$=[{title:"ID",key:"id",width:60,fixed:"left"},{title:"用户ID",key:"user_id",width:80},{title:"用户昵称",key:"nickname",width:100},{title:"FB ID",key:"fb_id",width:180},{title:"提现金额",key:"withdraw_amount",width:120,render(t){return`¥${T(t.withdraw_amount)}`}},{title:"状态",key:"status",width:100,render(t){const e=k[t.status]||{};return oe(se,{type:e.type,bordered:!1,size:"small"},{default:()=>e.label})}},{title:"用户端备注",key:"user_remark",width:150,ellipsis:{tooltip:!0}},{title:"后台备注",key:"admin_remark",width:150,ellipsis:{tooltip:!0}},{title:"创建时间",key:"create_time",width:180}],i=h({page:1,pageSize:10,pageCount:1,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50],onChange:void 0,onUpdatePageSize:void 0});function T(t){return new Intl.NumberFormat("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function R(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999);if(m.value&&m.value.length===2){const r=new Date(m.value[0]);r.setHours(0,0,0,0);const f=new Date(m.value[1]);return f.setHours(23,59,59,999),{start_date:Math.floor(r.getTime()/1e3),end_date:Math.floor(f.getTime()/1e3)}}switch(v.value){case"今日":return{start_date:Math.floor(e.getTime()/1e3),end_date:Math.floor(a.getTime()/1e3)};case"本周":const r=new Date(e);return r.setDate(e.getDate()-e.getDay()),{start_date:Math.floor(r.getTime()/1e3),end_date:Math.floor(a.getTime()/1e3)};case"本月":const f=new Date(t.getFullYear(),t.getMonth(),1);return{start_date:Math.floor(f.getTime()/1e3),end_date:Math.floor(a.getTime()/1e3)};case"本年":default:const D=new Date(t.getFullYear(),0,1);return{start_date:Math.floor(D.getTime()/1e3),end_date:Math.floor(a.getTime()/1e3)}}}function p(){return U(this,null,function*(){try{o.value=!0;const t=R(),e=N({limit:String(i.value.pageSize),page:String(i.value.page)},t);l.value.user_id&&(e.user_id=parseInt(l.value.user_id)),l.value.nickname&&(e.nickname=l.value.nickname),l.value.status!==null&&(e.status=l.value.status);const a=yield A(e);a.code===1&&a.data?(d.value.total_withdraw_count=a.data.total_recharge_count||0,d.value.total_withdraw_amount=a.data.total_recharge_amount||0,d.value.top_users=a.data.top_users||[],d.value.detail_list=a.data.detail_list||[],a.data.pagination&&(i.value.page=a.data.pagination.page,i.value.pageCount=a.data.pagination.pageCount,i.value.itemCount=a.data.pagination.itemCount,i.value.onChange=r=>{i.value.page=r,p()},i.value.onUpdatePageSize=r=>{i.value.pageSize=r,i.value.page=1,p()})):u.error(a.message||"加载数据失败")}catch(t){console.error("加载数据失败:",t),u.error("加载数据失败")}finally{o.value=!1}})}function V(t){v.value=t,t!=="自定义"&&(m.value=null),p()}function W(t){t&&p()}function Y(){i.value.page=1,p()}function O(){l.value={user_id:"",nickname:"",status:null},i.value.page=1,p()}return Z(()=>{p()}),(t,e)=>{const a=ue,r=ie,f=he,D=re,x=de,y=_e,P=ce,j=me,q=pe,z=ge,E=ve;return C(),B(a,{vertical:"",size:"large"},{default:s(()=>[n(a,{justify:"space-between",align:"start"},{default:s(()=>[n(a,{size:"large"},{default:s(()=>[g("div",we,[e[4]||(e[4]=g("div",{class:"summary-label"},"总提现次数",-1)),g("div",ye,S(d.value.total_withdraw_count)+"次",1)]),g("div",be,[e[5]||(e[5]=g("div",{class:"summary-label"},"总提现金额",-1)),g("div",ke,"￥"+S(T(d.value.total_withdraw_amount)),1)])]),_:1}),g("div",De,[n(X,{title:"提现排行榜",items:d.value.top_users,"action-type":"withdraw"},null,8,["items"])])]),_:1}),n(a,null,{default:s(()=>[n(f,null,{default:s(()=>[(C(),ee(ae,null,te(b,_=>n(r,{key:_.value,type:v.value===_.value?"primary":"default",onClick:Se=>V(_.value)},{default:s(()=>[M(S(_.label),1)]),_:2},1032,["type","onClick"])),64))]),_:1}),v.value==="自定义"?(C(),B(D,{key:0,value:m.value,"onUpdate:value":[e[0]||(e[0]=_=>m.value=_),W],type:"daterange",clearable:""},null,8,["value"])):ne("",!0)]),_:1}),n(z,{bordered:!1},{default:s(()=>[n(q,{inline:"","label-placement":"left"},{default:s(()=>[n(y,{label:"用户ID"},{default:s(()=>[n(x,{value:l.value.user_id,"onUpdate:value":e[1]||(e[1]=_=>l.value.user_id=_),placeholder:"请输入",style:{width:"150px"},clearable:""},null,8,["value"])]),_:1}),n(y,{label:"用户昵称"},{default:s(()=>[n(x,{value:l.value.nickname,"onUpdate:value":e[2]||(e[2]=_=>l.value.nickname=_),placeholder:"请输入",style:{width:"150px"},clearable:""},null,8,["value"])]),_:1}),n(y,{label:"状态"},{default:s(()=>[n(P,{value:l.value.status,"onUpdate:value":e[3]||(e[3]=_=>l.value.status=_),options:w,placeholder:"请选择",style:{width:"150px"},clearable:""},null,8,["value"])]),_:1}),n(y,null,{default:s(()=>[n(a,null,{default:s(()=>[n(r,{type:"primary",onClick:Y},{icon:s(()=>[n(j,null,{default:s(()=>[n(le(G))]),_:1})]),default:s(()=>[e[6]||(e[6]=M(" 查询 "))]),_:1}),n(r,{onClick:O},{default:s(()=>e[7]||(e[7]=[M("重置")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(z,{bordered:!1},{default:s(()=>[n(E,{columns:$,data:d.value.detail_list,pagination:i.value,bordered:!1,"scroll-x":1500,loading:o.value},null,8,["data","pagination","loading"])]),_:1})]),_:1})}}}),Ne=fe(Ce,[["__scopeId","data-v-b96c15bb"]]);export{Ne as default};
