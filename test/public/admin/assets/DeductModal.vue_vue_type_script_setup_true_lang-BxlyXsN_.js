var x=(c,v,u)=>new Promise((d,r)=>{var l=n=>{try{_(u.next(n))}catch(m){r(m)}},p=n=>{try{_(u.throw(n))}catch(m){r(m)}},_=n=>n.done?d(n.value):Promise.resolve(n.value).then(l,p);_((u=u.apply(c,v)).next())});import{d as E,u as N,r as y,b as S,aa as D,o as V,x as h,w as t,j as s,i,dW as j,k as z,l as F,U as G,F as P,D as T,G as W,_ as A,B as H,E as I}from"./index-CoBJkS1T.js";const L=E({__name:"DeductModal",props:{visible:{type:Boolean},userData:{}},emits:["update:visible","success"],setup(c,{emit:v}){const u=N(),d=y(),r=y(!1),l=y(!1),p=c,_=v,n=S({id:0,money:0,type:1,user_remarks:""}),m={money:{required:!0,type:"number",message:"请输入扣款金额",trigger:["blur","change"],validator:(a,e)=>!e||e<=0?new Error("扣款金额必须大于0"):!0},type:{required:!0,type:"number",message:"请选择扣款类型",trigger:["change"]},user_remarks:{required:!0,message:"请输入用户端备注",trigger:["blur","input"]}};D(()=>p.visible,a=>{l.value=a,a&&p.userData&&(n.id=p.userData.id,n.money=0,n.type=1,n.user_remarks="")}),D(l,a=>{_("update:visible",a)});const B=()=>{l.value=!1},C=()=>x(this,null,function*(){var a;try{yield(a=d.value)==null?void 0:a.validate(),r.value=!0;const e=yield j(n);e.code===1?(u.success("扣款成功"),l.value=!1,_("success")):u.error(e.msg||"扣款失败")}catch(e){console.error("表单提交错误:",e)}finally{r.value=!1}});return(a,e)=>{const b=z,f=F,U=G,g=P,w=T,M=W,R=A,k=H,q=I;return V(),h(q,{show:l.value,"onUpdate:show":e[3]||(e[3]=o=>l.value=o),"show-icon":!1,preset:"dialog",title:"用户扣款",style:{width:"500px"}},{action:t(()=>[s(w,null,{default:t(()=>[s(k,{onClick:B},{default:t(()=>e[8]||(e[8]=[i("取消")])),_:1}),s(k,{type:"error",loading:r.value,onClick:C},{default:t(()=>e[9]||(e[9]=[i("确定扣款")])),_:1},8,["loading"])]),_:1})]),default:t(()=>[s(R,{model:n,rules:m,ref_key:"formRef",ref:d,"label-placement":"left","label-width":100,class:"py-4"},{default:t(()=>[s(f,{label:"用户名"},{default:t(()=>{var o;return[s(b,{value:(o=a.userData)==null?void 0:o.username,disabled:""},null,8,["value"])]}),_:1}),s(f,{label:"扣款金额",path:"money"},{default:t(()=>[s(U,{value:n.money,"onUpdate:value":e[0]||(e[0]=o=>n.money=o),min:0,precision:2,placeholder:"请输入扣款金额",style:{width:"100%"}},{prefix:t(()=>e[4]||(e[4]=[i("¥")])),_:1},8,["value"])]),_:1}),s(f,{label:"扣款类型",path:"type"},{default:t(()=>[s(M,{value:n.type,"onUpdate:value":e[1]||(e[1]=o=>n.type=o)},{default:t(()=>[s(w,null,{default:t(()=>[s(g,{value:1},{default:t(()=>e[5]||(e[5]=[i("真实")])),_:1}),s(g,{value:2},{default:t(()=>e[6]||(e[6]=[i("虚拟")])),_:1}),s(g,{value:3},{default:t(()=>e[7]||(e[7]=[i("系统")])),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),s(f,{label:"用户端备注",path:"user_remarks"},{default:t(()=>[s(b,{type:"textarea",placeholder:"请输入用户端备注",value:n.user_remarks,"onUpdate:value":e[2]||(e[2]=o=>n.user_remarks=o),autosize:{minRows:2,maxRows:4}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])}}});export{L as _};
